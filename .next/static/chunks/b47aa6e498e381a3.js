(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,145587,e=>{"use strict";e.s(["encodeIntoResult",()=>c,"stegaEncodeSourceMap",()=>m,"stegaEncodeSourceMap$1",()=>v]);var t=e.i(247984);let r=/_key\s*==\s*['"](.*)['"]/;function n(e){if(!Array.isArray(e))throw Error("Path is not an array");return e.reduce((e,t,n)=>{let i=typeof t;if("number"===i)return"".concat(e,"[").concat(t,"]");if("string"===i)return"".concat(e).concat(0===n?"":".").concat(t);if(("string"==typeof t?r.test(t.trim()):"object"==typeof t&&"_key"in t)&&t._key)return"".concat(e,'[_key=="').concat(t._key,'"]');if(Array.isArray(t)){let[r,n]=t;return"".concat(e,"[").concat(r,":").concat(n,"]")}throw Error("Unsupported path segment `".concat(JSON.stringify(t),"`"))},"")}let i={"\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","'":"\\'","\\":"\\\\"},o={"\\f":"\f","\\n":"\n","\\r":"\r","\\t":"	","\\'":"'","\\\\":"\\"};function a(e){let t,r=[],n=/\['(.*?)'\]|\[(\d+)\]|\[\?\(@\._key=='(.*?)'\)\]/g;for(;null!==(t=n.exec(e));){if(void 0!==t[1]){let e=t[1].replace(/\\(\\|f|n|r|t|')/g,e=>o[e]);r.push(e);continue}if(void 0!==t[2]){r.push(parseInt(t[2],10));continue}if(void 0!==t[3]){let e=t[3].replace(/\\(\\')/g,e=>o[e]);r.push({_key:e,_index:-1});continue}}return r}function l(e){return e.map(e=>{if("string"==typeof e||"number"==typeof e)return e;if(""!==e._key)return{_key:e._key};if(-1!==e._index)return e._index;throw Error("invalid segment:".concat(JSON.stringify(e)))})}function c(e,r,n){return function e(r,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(null!==r&&Array.isArray(r))return r.map((r,o)=>{if((0,t.isRecord)(r)){let t=r._key;if("string"==typeof t)return e(r,n,i.concat({_key:t,_index:o}))}return e(r,n,i.concat(o))});if((0,t.isRecord)(r)){if("block"===r._type||"span"===r._type){let t={...r};return"block"===r._type?t.children=e(r.children,n,i.concat("children")):"span"===r._type&&(t.text=e(r.text,n,i.concat("text"))),t}return Object.fromEntries(Object.entries(r).map(t=>{let[r,o]=t;return[r,e(o,n,i.concat(r))]}))}return n(r,i)}(e,(e,t)=>{if("string"!=typeof e)return e;let o=function(e,t){var r;if(!(null==t?void 0:t.mappings))return;let n=(r=e.map(e=>{if("string"==typeof e||"number"==typeof e)return e;if(-1!==e._index)return e._index;throw Error("invalid segment:".concat(JSON.stringify(e)))}),"$".concat(r.map(e=>"string"==typeof e?"['".concat(e.replace(/[\f\n\r\t'\\]/g,e=>i[e]),"']"):"number"==typeof e?"[".concat(e,"]"):""!==e._key?"[?(@._key=='".concat(e._key.replace(/['\\]/g,e=>i[e]),"')]"):"[".concat(e._index,"]")).join("")));if(void 0!==t.mappings[n])return{mapping:t.mappings[n],matchedPath:n,pathSuffix:""};let o=Object.entries(t.mappings).filter(e=>{let[t]=e;return n.startsWith(t)}).sort((e,t)=>{let[r]=e,[n]=t;return n.length-r.length});if(0==o.length)return;let[a,l]=o[0],c=n.substring(a.length);return{mapping:l,matchedPath:a,pathSuffix:c}}(t,r);if(!o)return e;let{mapping:l,matchedPath:c}=o;if("value"!==l.type||"documentValue"!==l.source.type)return e;let s=r.documents[l.source.document],u=r.paths[l.source.path],p=a(c);return n({sourcePath:a(u).concat(t.slice(p.length)),sourceDocument:s,resultPath:t,value:e})})}let s="".concat("drafts").concat("."),u="".concat("versions").concat(".");function p(e){return e.startsWith(s)}function f(e){return e.startsWith(u)}let d=e=>{let{sourcePath:t,resultPath:r,value:n}=e;if(function(e){return!!/^\d{4}-\d{2}-\d{2}/.test(e)&&!!Date.parse(e)}(n)||function(e){try{let{protocol:t}=new URL(e,e.startsWith("/")?"https://acme.com":void 0);return g.has(t)||t.startsWith("web+")}catch(e){return!1}}(n))return!1;let i=t.at(-1);return!("slug"===t.at(-2)&&"current"===i||"string"==typeof i&&(i.startsWith("_")||i.endsWith("Id"))||t.some(e=>"meta"===e||"metadata"===e||"openGraph"===e||"seo"===e)||y(t)||y(r)||"string"==typeof i&&h.has(i))},h=new Set(["color","colour","currency","email","format","gid","hex","href","hsl","hsla","icon","id","index","key","language","layout","link","linkAction","locale","lqip","page","path","ref","rgb","rgba","route","secret","slug","status","tag","template","theme","type","textTheme","unit","url","username","variant","website"]),g=new Set(["app:","data:","discord:","file:","ftp:","ftps:","geo:","http:","https:","imap:","javascript:","magnet:","mailto:","maps:","ms-excel:","ms-powerpoint:","ms-word:","slack:","sms:","spotify:","steam:","teams:","tel:","vscode:","zoom:"]);function y(e){return e.some(e=>"string"==typeof e&&null!==e.match(/type/i))}function m(e,i,o){var a,u,h,g,y,m,v,_,b;let{filter:k,logger:w,enabled:E}=o;if(!E){let t="config.enabled must be true, don't call this function otherwise";throw null==w||null==(u=w.error)||u.call(w,"[@sanity/client]: ".concat(t),{result:e,resultSourceMap:i,config:o}),TypeError(t)}if(!i)return null==w||null==(a=w.error)||a.call(w,"[@sanity/client]: Missing Content Source Map from response body",{result:e,resultSourceMap:i,config:o}),e;if(!o.studioUrl){let t="config.studioUrl must be defined";throw null==w||null==(h=w.error)||h.call(w,"[@sanity/client]: ".concat(t),{result:e,resultSourceMap:i,config:o}),TypeError(t)}let S=[],x=[],j=c(e,i,e=>{var r;let i,{sourcePath:a,sourceDocument:c,resultPath:u,value:h}=e;if(("function"==typeof k?k({sourcePath:a,resultPath:u,filterDefault:d,sourceDocument:c,value:h}):d({sourcePath:a,resultPath:u,value:h}))===!1)return w&&x.push({path:n(l(a)),value:"".concat(h.slice(0,20)).concat(h.length>20?"...":""),length:h.length}),h;w&&S.push({path:n(l(a)),value:"".concat(h.slice(0,20)).concat(h.length>20?"...":""),length:h.length});let{baseUrl:g,workspace:y,tool:m}=("/"!==(i="string"==typeof(r="function"==typeof o.studioUrl?o.studioUrl(c):o.studioUrl)?r:r.baseUrl)&&(i=i.replace(/\/$/,"")),"string"==typeof r?{baseUrl:i}:{...r,baseUrl:i});if(!g)return h;let{_id:v,_type:_,_projectId:b,_dataset:E}=c;return(0,t.C)(h,{origin:"sanity.io",href:function(e){let{baseUrl:t,workspace:r="default",tool:i="default",id:o,type:a,path:c,projectId:u,dataset:d}=e;if(!t)throw Error("baseUrl is required");if(!c)throw Error("path is required");if(!o)throw Error("id is required");if("/"!==t&&t.endsWith("/"))throw Error("baseUrl must not end with a slash");let h="default"===r?void 0:r,g="default"===i?void 0:i,y=f(o)?o.split(".").slice(2).join("."):p(o)?o.slice(s.length):o,m=Array.isArray(c)?n(l(c)):c,v=new URLSearchParams({baseUrl:t,id:y,type:a,path:m});if(h&&v.set("workspace",h),g&&v.set("tool",g),u&&v.set("projectId",u),d&&v.set("dataset",d),p(o)||f(o)){if(f(o)){let e=function(e){if(!f(e))return;let[t,r,...n]=e.split(".");return r}(o);v.set("perspective",e)}}else v.set("perspective","published");let _=["/"===t?"":t];h&&_.push(h);let b=["mode=presentation","id=".concat(y),"type=".concat(a),"path=".concat(encodeURIComponent(m))];return g&&b.push("tool=".concat(g)),_.push("intent","edit","".concat(b.join(";"),"?").concat(v)),_.join("/")}({baseUrl:g,workspace:y,tool:m,id:v,type:_,path:a,...!o.omitCrossDatasetReferenceData&&{dataset:E,projectId:b}})},!1)});if(w){let e=x.length,t=S.length;if((e||t)&&(null==(g=(null==w?void 0:w.groupCollapsed)||w.log)||g("[@sanity/client]: Encoding source map into result"),null==(y=w.log)||y.call(w,"[@sanity/client]: Paths encoded: ".concat(S.length,", skipped: ").concat(x.length))),S.length>0&&(null==w||null==(m=w.log)||m.call(w,"[@sanity/client]: Table of encoded paths"),null==(v=(null==w?void 0:w.table)||w.log)||v(S)),x.length>0){let e=new Set;for(let{path:t}of x)e.add(t.replace(r,"0").replace(/\[\d+\]/g,"[]"));null==w||null==(b=w.log)||b.call(w,"[@sanity/client]: List of skipped paths",[...e.values()])}(e||t)&&(null==w||null==(_=w.groupEnd)||_.call(w))}return j}var v=Object.freeze({__proto__:null,stegaEncodeSourceMap:m})},315786,e=>{"use strict";e.s(["default",()=>c]);var t=e.i(843476),r=e.i(145587),n=e.i(75389),i=e.i(271645),o=e.i(462576),a=e.i(570148);let l="use"in i?i.use:()=>{throw TypeError("SanityLiveStream requires a React version with React.use()")};function c(e){let{query:c,dataset:s,params:u={},perspective:p,projectId:f,stega:d}=e,h=(0,i.useCallback)(e=>(a.comlinkListeners.add(e),()=>a.comlinkListeners.delete(e)),[]),g=(0,i.useSyncExternalStore)(h,()=>a.comlink,()=>null),[y,m]=(0,i.useState)(void 0),v=(0,o.useEffectEvent)(e=>{e.post("loader/query-listen",{projectId:f,dataset:s,perspective:p,query:c,params:u,heartbeat:1e4})}),_=(0,o.useEffectEvent)(t=>{if((0,n.dequal)({projectId:f,dataset:s,query:c,params:u},{projectId:t.projectId,dataset:t.dataset,query:t.query,params:t.params})){let{result:n,resultSourceMap:i,tags:o}=t,a=d?(0,r.stegaEncodeSourceMap)(n,i,{enabled:!0,studioUrl:"/"}):n;console.groupCollapsed("rendering with server action"),e.children({data:a,sourceMap:i,tags:o||[]}).then(e=>{console.log("setChildren(children)"),m(e)},e=>{console.error("rendering with server action: render children error",e)}).finally(()=>console.groupEnd())}});return(0,i.useEffect)(()=>{if(!g)return;let e=g.on("loader/query-change",_),t=setInterval(()=>v(g),1e4);return()=>{clearInterval(t),e()}},[g]),g&&void 0!==y?(0,t.jsx)(t.Fragment,{children:y}):l(e.initial)}c.displayName="SanityLiveStream"}]);