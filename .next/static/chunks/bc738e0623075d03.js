(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31669,e=>{"use strict";let t;e.s(["default",()=>rs],31669);var r=e.i(892510),n=e.i(843476),i=e.i(881933),a=e.i(695713),o=e.i(926005),s=e.i(881283),l=e.i(636536),c=e.i(821186),u=e.i(725917),d=e.i(678491),p=e.i(271645),m=e.i(537152),f=e.i(216024),h=e.i(201226),v=e.i(997053),g=e.i(462576),w=e.i(509820),y=e.i(968207),x=e.i(807574),b=e.i(663567),b=b,P=e.i(527108),S=e.i(447912),j=e.i(923064),_=e.i(738465),E=e.i(312669),k=e.i(970725),C=e.i(666539);let T={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},R=new Uint8Array(16),A=[];for(let e=0;e<256;++e)A.push((e+256).toString(16).slice(1));let U=function(e,r,n){var i,a,o;if(T.randomUUID&&!r&&!e)return T.randomUUID();let s=null!=(o=null!=(a=(e=e||{}).random)?a:null==(i=e.rng)?void 0:i.call(e))?o:function(){if(!t){if("undefined"==typeof crypto||!crypto.getRandomValues)throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");t=crypto.getRandomValues.bind(crypto)}return t(R)}();if(s.length<16)throw Error("Random bytes length must be >= 16");if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,r){if((n=n||0)<0||n+16>r.length)throw RangeError("UUID byte range ".concat(n,":").concat(n+15," is out of buffer bounds"));for(let e=0;e<16;++e)r[n+e]=s[e];return r}return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(A[e[t+0]]+A[e[t+1]]+A[e[t+2]]+A[e[t+3]]+"-"+A[e[t+4]]+A[e[t+5]]+"-"+A[e[t+6]]+A[e[t+7]]+"-"+A[e[t+8]]+A[e[t+9]]+"-"+A[e[t+10]]+A[e[t+11]]+A[e[t+12]]+A[e[t+13]]+A[e[t+14]]+A[e[t+15]]).toLowerCase()}(s)};var I=e.i(846932),L=e.i(88653),M=e.i(737806),O=e.i(798125),z=e.i(947414);function N(e){let{children:t,isValidProp:r,...i}=e;r&&(0,O.loadExternalIsValidProp)(r),(i={...(0,p.useContext)(M.MotionConfigContext),...i}).isStatic=(0,z.useConstant)(()=>i.isStatic);let a=(0,p.useMemo)(()=>i,[JSON.stringify(i.transition),i.transformPagePoint,i.reducedMotion]);return(0,n.jsx)(M.MotionConfigContext.Provider,{value:a,children:t})}var F=e.i(174080),B=e.i(551657);function D(){if("u">typeof crypto){let e=new Uint8Array(16);crypto.getRandomValues(e);let t="";for(let r=0;r<e.length;r++)t+=e[r].toString(16).padStart(2,"0");return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/[=]+$/,"")}return Math.random().toString(36).slice(2)}async function V(e,t,r,n){let i=e.withConfig({apiVersion:c.apiVersion}),a=D(),o=i.patch(c.schemaIdSingleton).set({secret:a,studioUrl:r,userId:n});return await i.transaction().createIfNotExists({_id:c.schemaIdSingleton,_type:c.schemaTypeSingleton,source:t,studioUrl:r,userId:n}).patch(o).commit({tag:c.tag}),{secret:a}}async function W(e,t,r,n){let i=e.withConfig({apiVersion:c.apiVersion}),a=i.patch(c.schemaIdSingleton).set({secret:null,studioUrl:r,userId:n});await i.transaction().createIfNotExists({_id:c.schemaIdSingleton,_type:c.schemaTypeSingleton,source:t,studioUrl:r,userId:n}).patch(a).commit({tag:c.tag})}var K=e.i(945736),$=e.i(629801);function H(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function q(e){return e&&e.sensitive?"":"i"}var X=e.i(815321);async function G(e,t,r,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:(0,X.uuid)(),a=e.withConfig({apiVersion:c.apiVersion});try{let e=new Date(Date.now()+1e3*c.SECRET_TTL),o="drafts.".concat(i),s=D(),l=a.patch(o).set({secret:s,source:t,studioUrl:r,userId:n});return await a.transaction().createOrReplace({_id:o,_type:c.schemaType}).patch(l).commit({tag:c.tag}),{secret:s,expiresAt:e}}finally{try{await a.delete({query:c.deleteExpiredSecretsQuery})}catch(e){console.error("Failed to delete expired secrets",e)}}}var J=e.i(254201);function Y(){let e=(0,r._)(["\n  overflow: hidden;\n  flex-basis: 0;\n  flex-shrink: 1;\n"]);return Y=function(){return e},e}function Q(){let e=(0,r._)(["\n  display: flex;\n  flex-direction: row;\n  height: 100%;\n  overflow: hidden;\n  width: 100%;\n"]);return Q=function(){return e},e}function Z(){let e=(0,r._)(["\n  height: 100%;\n"]);return Z=function(){return e},e}function ee(){let e=(0,r._)(["\n  & > div {\n    min-width: none !important;\n    max-width: none !important;\n  }\n"]);return ee=function(){return e},e}function et(){let e=(0,r._)(["\n  white-space: pre-wrap;\n"]);return et=function(){return e},e}function er(){let e=(0,r._)(["\n  white-space: pre-wrap;\n"]);return er=function(){return e},e}function en(){let e=(0,r._)(["\n  position: relative;\n"]);return en=function(){return e},e}function ei(){let e=(0,r._)(["\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: -5px;\n  width: 9px;\n  z-index: 10;\n  cursor: ",";\n\n  /* Border */\n  & > span:nth-child(1) {\n    display: block;\n    border-left: 1px solid var(--card-border-color);\n    position: absolute;\n    top: 0;\n    left: 4px;\n    bottom: 0;\n    transition: opacity 200ms;\n  }\n\n  ","\n"]);return ei=function(){return e},e}function ea(){let e=(0,r._)(["\n  box-shadow: 0 0 0 1px var(--card-border-color);\n  border: 0;\n  max-height: 100%;\n  width: 100%;\n  view-transition-class: presentation-tool-iframe;\n"]);return ea=function(){return e},e}function eo(){let e=(0,r._)(["\n  position: absolute;\n  inset: 0;\n  background: transparent;\n"]);return eo=function(){return e},e}function es(){let e=(0,r._)(["\nhtml:active-view-transition-type(sanity-iframe-viewport) {\n  view-transition-name: none;\n  &::view-transition {\n    pointer-events: none;\n  }\n  /* &::view-transition-old(root) {\n    display: none;\n  }\n  &::view-transition-new(root) {\n    animation: none;\n  } */\n}\n"]);return es=function(){return e},e}function el(){let e=(0,r._)(["\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  height: ","px;\n  width: ","px;\n"]);return el=function(){return e},e}function ec(){let e=(0,r._)(["\n  overflow-x: auto;\n"]);return ec=function(){return e},e}var eu=(0,p.memo)(e=>{let t,r,n=(0,i.c)(3),{comlink:a}=e;return n[0]!==a?(t=()=>a.on("visual-editing/features",ed),r=[a],n[0]=a,n[1]=t,n[2]=r):(t=n[1],r=n[2]),(0,p.useEffect)(t,r),null});function ed(){return{features:{optimistic:!0}}}let ep=(0,w.setup)({types:{},actions:{},actors:{},guards:{}}).createMachine({id:"Presentation Tool",context:{url:null,error:null,visualEditingOverlaysEnabled:!1},on:{"iframe reload":{actions:(0,y.assign)({url:null}),target:".loading"}},states:{error:{description:"Failed to load, either because of a misconfiguration, a network error, or an unexpected error",tags:["error"]},loading:{on:{"iframe loaded":{target:"loaded"}},tags:["busy"]},loaded:{on:{"toggle visual editing overlays":{actions:(0,y.assign)({visualEditingOverlaysEnabled:e=>{let{event:t}=e;return t.enabled}})},"iframe refresh":{target:".refreshing"},"iframe reload":{target:".reloading"}},states:{idle:{},refreshing:{on:{"iframe loaded":{target:"idle"}},tags:["busy"]},reloading:{on:{"iframe loaded":{target:"idle"}},tags:["busy"]}},initial:"idle"}},initial:"loading"}),em=function(e){let t,r,a,o,s,l,c,u=(0,i.c)(14),{comlink:d,children:m}=e;u[0]===Symbol.for("react.memo_cache_sentinel")?(t={},u[0]=t):t=u[0];let f=(0,p.useRef)(t);u[1]!==d?(r=()=>null==d?void 0:d.on("visual-editing/shared-state",()=>({state:f.current})),a=[d],u[1]=d,u[2]=r,u[3]=a):(r=u[2],a=u[3]),(0,p.useEffect)(r,a),u[4]!==d?(o=(e,t)=>{f.current[e]=t,null==d||d.post("presentation/shared-state",{key:e,value:t})},u[4]=d,u[5]=o):o=u[5];let h=o;u[6]!==d?(s=e=>{null==d||d.post("presentation/shared-state",{key:e}),delete f.current[e]},u[6]=d,u[7]=s):s=u[7];let v=s;u[8]!==v||u[9]!==h?(l={removeValue:v,setValue:h},u[8]=v,u[9]=h,u[10]=l):l=u[10];let g=l;return u[11]!==m||u[12]!==g?(c=(0,n.jsx)(P.PresentationSharedStateContext.Provider,{value:g,children:m}),u[11]=m,u[12]=g,u[13]=c):c=u[13],c},ef=v.styled.div(Y()),eh=function(e){let t,r,a,o,s=(0,i.c)(15),{children:l,defaultSize:c,id:u,minWidth:d,maxWidth:m,order:f}=e,h=void 0===c?null:c,v=void 0===f?0:f,g=(0,p.useContext)(P.PresentationPanelsContext);if(null===g)throw Error("Panel components must be rendered within a PanelGroup container");let{getPanelStyle:w,registerElement:y,unregisterElement:x}=g;s[0]!==w||s[1]!==u?(t=w(u),s[0]=w,s[1]=u,s[2]=t):t=s[2];let b=t;return s[3]!==h||s[4]!==u||s[5]!==m||s[6]!==d||s[7]!==v||s[8]!==y||s[9]!==x?(r=()=>(y(u,{id:u,type:"panel",defaultSize:h,maxWidth:null!=m?m:null,minWidth:null!=d?d:0,order:v}),()=>{x(u)}),a=[u,h,v,m,d,y,x],s[3]=h,s[4]=u,s[5]=m,s[6]=d,s[7]=v,s[8]=y,s[9]=x,s[10]=r,s[11]=a):(r=s[10],a=s[11]),(0,p.useLayoutEffect)(r,a),s[12]!==l||s[13]!==b?(o=(0,n.jsx)(ef,{style:b,children:l}),s[12]=l,s[13]=b,s[14]=o):o=s[14],o};function ev(e,t){let r;return function(){for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];clearTimeout(r),r=setTimeout(()=>{e.apply(e,i)},t)}}let eg="presentation/panels",ew=()=>JSON.parse(localStorage.getItem(eg)||"{}"),ey=e=>e.map(e=>[e.id,e.order].join(":")).join(",");function ex(e,t){var r;let n=ew(),i=ey(e);r={...n,[i]:t},localStorage.setItem(eg,JSON.stringify(r))}function eb(e){let t=ew(),r=ey(e);return Array.isArray(t[r])&&t[r].some(eP)?void 0:t[r]}function eP(e){return null===e}function eS(e,t,r){let{maxWidth:n,minWidth:i}=e;return Math.min(null==n?100:n/r*100,Math.max(i/r*100,t))}function ej(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return e.clientX-(n||t.getBoundingClientRect()).left-r}function e_(e){return"panel"===e.type}function eE(e){return"resizer"===e.type}function ek(e){return Array.from(e.values()).sort((e,t)=>{let{order:r}=e,{order:n}=t;return null==r&&null==n?0:null==r?-1:null==n?1:r-n})}function eC(e,t,r){let n=t.reduce((e,t)=>e+t,0),i=[...t].map(e=>e/n*100),a=0;for(let t=0;t<e.length;t++){let n=e[t],o=i[t],s=eS(n,o,r);o!=s&&(a+=o-s,i[t]=s)}if("0.000"!==a.toFixed(3))for(let t=0;t<e.length;t++){let{maxWidth:n,minWidth:o}=e[t];o=o/r*100,null!=n&&(n=n/r*100);let s=Math.min(null!=n?n:100,Math.max(o,i[t]+a));if(s!==i[t]&&(a-=s-i[t],i[t]=s,"0.000"===Math.abs(a).toFixed(3)))break}return i}let eT=v.styled.div(Q()),eR=function(e){let t,r,a,o,s,l,c,u,d,m,f,h,v,g,w,y,x,b,S,j,_,E,k=(0,i.c)(46),{children:C}=e,T=(0,p.useRef)(null);k[0]===Symbol.for("react.memo_cache_sentinel")?(t=new Map,k[0]=t):t=k[0];let[R,A]=(0,p.useState)(t);k[1]!==R?(r=ek(R).filter(e_),k[1]=R,k[2]=r):r=k[2];let U=r;k[3]===Symbol.for("react.memo_cache_sentinel")?(a=[],k[3]=a):a=k[3];let[I,L]=(0,p.useState)(a),[M,O]=(0,p.useState)(null);k[4]!==R||k[5]!==U||k[6]!==I?(o={elements:R,panels:U,widths:I},k[4]=R,k[5]=U,k[6]=I,k[7]=o):o=k[7];let z=(0,p.useRef)(o);k[8]!==M||k[9]!==U||k[10]!==I?(s=e=>({flexGrow:function(e,t,r){if(1===e.length)return"100";let n=r[e.findIndex(e=>e.id===t)];return null==n?"0":n.toPrecision(10)}(U,e,I),pointerEvents:null===M?void 0:"none"}),k[8]=M,k[9]=U,k[10]=I,k[11]=s):s=k[11];let N=s;k[12]===Symbol.for("react.memo_cache_sentinel")?(l=(e,t)=>{A(r=>{if(r.has(e))return r;let n=new Map(r);return n.set(e,t),n})},k[12]=l):l=k[12];let F=l;k[13]===Symbol.for("react.memo_cache_sentinel")?(c=e=>{A(t=>{if(!t.has(e))return t;let r=new Map(t);return r.delete(e),r})},k[13]=c):c=k[13];let B=c;k[14]===Symbol.for("react.memo_cache_sentinel")?(u={containerWidth:window.innerWidth,dragOffset:0,panelAfter:null,panelBefore:null,resizerIndex:-1,resizerRect:null,startX:0,widths:[]},k[14]=u):u=k[14];let D=(0,p.useRef)(u);k[15]!==R?(d=(e,t)=>{let r=ek(R),n=r.findIndex(t=>t.id===e),i=R.get(e);if(!i||!eE(i))return;let a=i.el.current;a&&(D.current={resizerIndex:n,panelBefore:r.reduce((e,t,r)=>e_(t)&&r<n?t:e,null),panelAfter:r.reduce((e,t,r)=>null===e&&e_(t)&&r>n?t:e,null),containerWidth:window.innerWidth,startX:t.pageX,dragOffset:ej(t,a),resizerRect:a.getBoundingClientRect(),widths:z.current.widths},O(e))},k[15]=R,k[16]=d):d=k[16];let V=d;k[17]===Symbol.for("react.memo_cache_sentinel")?(m=()=>{O(null)},k[17]=m):m=k[17];let W=m;k[18]!==R?(f=(e,t)=>{t.preventDefault(),t.stopPropagation();let{containerWidth:r,dragOffset:n,panelBefore:i,panelAfter:a,resizerRect:o}=D.current;if(null==i||null==a)return;let s=R.get(e);if(!s||!eE(s))return;let l=s.el.current;if(!l)return;let c=ej(t,l,n,o);if(0===c)return;let{widths:u}=z.current,d=function(e,t,r,n,i,a){let{panels:o,widths:s}=i,{widths:l}=a,c=l||s,u=[...c];{let i=e<0?n:r,a=c[o.findIndex(e=>e.id===i.id)],s=eS(i,a+Math.abs(e),t);if(a===s)return c;e=e<0?a-s:s-a}let d=0,p=e<0?r:n,m=o.findIndex(e=>e.id===p.id);for(;;){let r=o[m],n=c[m],i=eS(r,n-(Math.abs(e)-Math.abs(d)),t);if(n!==i&&(d+=n-i,u[m]=i,d.toPrecision(10).localeCompare(Math.abs(e).toPrecision(10),void 0,{numeric:!0})>=0))break;if(e<0){if(--m<0)break}else if(++m>=o.length)break}return 0===d?c:(p=e<0?n:r,u[m=o.findIndex(e=>e.id===p.id)]=c[m]+d,u)}(c/T.current.getBoundingClientRect().width*100,r,i,a,z.current,D.current);u.some((e,t)=>e!==d[t])&&L(d)},k[18]=R,k[19]=f):f=k[19];let K=f;k[20]!==R||k[21]!==U||k[22]!==I?(h=()=>{z.current.elements=R,z.current.panels=U,z.current.widths=I},v=[R,U,I],k[20]=R,k[21]=U,k[22]=I,k[23]=h,k[24]=v):(h=k[23],v=k[24]),(0,p.useLayoutEffect)(h,v);let $=function(){let e,t=(0,i.c)(1);return t[0]===Symbol.for("react.memo_cache_sentinel")?(e={get:eb,set:ex,setDebounced:ev(ex,100)},t[0]=e):e=t[0],e}();k[25]!==U||k[26]!==$?(g=()=>{let{widths:e}=z.current;if(e.length===U.length)return;let t=$.get(U);if(t)return void L(eC(U,t,window.innerWidth));L(function(e){let t=e.length,r=100,n=e.map(e=>e.defaultSize?(r-=e.defaultSize,t-=1,e.defaultSize):null),i=r/t;return n.map(e=>null===e?i:e)}(U))},w=[$,U],k[25]=U,k[26]=$,k[27]=g,k[28]=w):(g=k[27],w=k[28]),(0,p.useLayoutEffect)(g,w),k[29]!==U||k[30]!==$||k[31]!==I?(y=()=>{I.length&&$.setDebounced(U,I)},x=[$,U,I],k[29]=U,k[30]=$,k[31]=I,k[32]=y,k[33]=x):(y=k[32],x=k[33]),(0,p.useEffect)(y,x),k[34]===Symbol.for("react.memo_cache_sentinel")?(b=()=>{let e=new ResizeObserver(()=>{let{panels:e,widths:t}=z.current,r=eC(e,t,window.innerWidth);t.some((e,t)=>e!==r[t])&&L(r)});return e.observe(T.current),()=>{e.disconnect()}},S=[],k[34]=b,k[35]=S):(b=k[34],S=k[35]),(0,p.useLayoutEffect)(b,S),k[36]!==M||k[37]!==K||k[38]!==N||k[39]!==V?(j={activeResizer:M,drag:K,getPanelStyle:N,registerElement:F,startDragging:V,stopDragging:W,unregisterElement:B},k[36]=M,k[37]=K,k[38]=N,k[39]=V,k[40]=j):j=k[40];let H=j;return k[41]!==C?(_=(0,n.jsx)(eT,{ref:T,children:C}),k[41]=C,k[42]=_):_=k[42],k[43]!==H||k[44]!==_?(E=(0,n.jsx)(P.PresentationPanelsContext.Provider,{value:H,children:_}),k[43]=H,k[44]=_,k[45]=E):E=k[45],E};function eA(e){let t,r,a,s,l,c,d,p,f,h,v,g,w,y,x,b,P=(0,i.c)(37);P[0]!==e?({children:t,message:r,onRetry:s,onContinueAnyway:a,...l}=e,P[0]=e,P[1]=t,P[2]=r,P[3]=a,P[4]=s,P[5]=l):(t=P[1],r=P[2],a=P[3],s=P[4],l=P[5]);let{t:S}=(0,m.useTranslation)(o.presentationLocaleNamespace);P[6]!==S?(c=S("error-card.retry-button.text"),P[6]=S,P[7]=c):c=P[7],P[8]!==s||P[9]!==c?(d=(0,n.jsx)(E.Button,{mode:"ghost",onClick:s,text:c}),P[8]=s,P[9]=c,P[10]=d):d=P[10];let j=d;P[11]!==S?(p=S("error-card.continue-button.text"),P[11]=S,P[12]=p):p=P[12],P[13]!==a||P[14]!==p?(f=(0,n.jsx)(E.Button,{mode:"ghost",tone:"critical",onClick:a,text:p}),P[13]=a,P[14]=p,P[15]=f):f=P[15];let _=f;return P[16]!==S?(h=S("error-card.title"),P[16]=S,P[17]=h):h=P[17],P[18]!==h?(v=(0,n.jsx)(u.Text,{size:1,weight:"semibold",children:h}),P[18]=h,P[19]=v):v=P[19],P[20]!==r?(g=(0,n.jsx)(u.Text,{muted:!0,size:1,children:r}),P[20]=r,P[21]=g):g=P[21],P[22]!==v||P[23]!==g?(w=(0,n.jsxs)(u.Stack,{space:3,children:[v,g]}),P[22]=v,P[23]=g,P[24]=w):w=P[24],P[25]!==_||P[26]!==a||P[27]!==s||P[28]!==j?(y=s&&a?(0,n.jsxs)(u.Inline,{space:2,children:[j,_]}):s?(0,n.jsx)(u.Box,{children:j}):a?(0,n.jsx)(u.Box,{children:_}):null,P[25]=_,P[26]=a,P[27]=s,P[28]=j,P[29]=y):y=P[29],P[30]!==t||P[31]!==w||P[32]!==y?(x=(0,n.jsx)(u.Flex,{align:"center",height:"fill",justify:"center",children:(0,n.jsx)(u.Container,{padding:4,sizing:"border",width:0,children:(0,n.jsxs)(u.Stack,{space:4,children:[w,t,y]})})}),P[30]=t,P[31]=w,P[32]=y,P[33]=x):x=P[33],P[34]!==l||P[35]!==x?(b=(0,n.jsx)(u.Card,{height:"fill",...l,children:x}),P[34]=l,P[35]=x,P[36]=b):b=P[36],b}let eU=(0,p.forwardRef)(function(e,t){let r,a,o,s,l,c,u,d,p=(0,i.c)(17);if(p[0]!==e){let{childId:t,childType:n,childPayload:i,childParameters:c,searchParams:u,...d}=e;r=t,o=n,a=c,l=u,s=d,p[0]=e,p[1]=r,p[2]=a,p[3]=o,p[4]=s,p[5]=l}else r=p[1],a=p[2],o=p[3],s=p[4],l=p[5];return p[6]!==a||p[7]!==l?(c=Object.entries({...l,...a}),p[6]=a,p[7]=l,p[8]=c):c=p[8],p[9]!==r||p[10]!==o||p[11]!==c?(u={id:r,type:o,_searchParams:c},p[9]=r,p[10]=o,p[11]=c,p[12]=u):u=p[12],p[13]!==t||p[14]!==s||p[15]!==u?(d=(0,n.jsx)(h.StateLink,{...s,ref:t,state:u}),p[13]=t,p[14]=s,p[15]=u,p[16]=d):d=p[16],d}),eI=(0,p.forwardRef)(function(e,t){let r,a,o,s,l,c,u,d,p,f,h=(0,i.c)(22);h[0]!==e?({documentId:r,documentType:a,parentRefPath:o,template:c,searchParams:l,...s}=e,h[0]=e,h[1]=r,h[2]=a,h[3]=o,h[4]=s,h[5]=l,h[6]=c):(r=h[1],a=h[2],o=h[3],s=h[4],l=h[5],c=h[6]);let v=null==c?void 0:c.params;return h[7]!==o?(u=(0,m.pathToString)(o),h[7]=o,h[8]=u):u=h[8],h[9]!==c?(d=c&&{template:null==c?void 0:c.id},h[9]=c,h[10]=d):d=h[10],h[11]!==u||h[12]!==d?(p={parentRefPath:u,...d},h[11]=u,h[12]=d,h[13]=p):p=h[13],h[14]!==r||h[15]!==a||h[16]!==t||h[17]!==s||h[18]!==l||h[19]!==v||h[20]!==p?(f=(0,n.jsx)(eU,{...s,ref:t,childId:r,childType:a,childPayload:v,childParameters:p,searchParams:l}),h[14]=r,h[15]=a,h[16]=t,h[17]=s,h[18]=l,h[19]=v,h[20]=p,h[21]=f):f=h[21],f}),eL=(0,p.forwardRef)(function(e,t){let r,a,o,s,l=(0,i.c)(9);return l[0]!==e?({searchParams:a,...r}=e,l[0]=e,l[1]=r,l[2]=a):(r=l[1],a=l[2]),l[3]!==a?(o={type:void 0,_searchParams:Object.entries(a)},l[3]=a,l[4]=o):o=l[4],l[5]!==t||l[6]!==r||l[7]!==o?(s=(0,n.jsx)(h.StateLink,{...r,ref:t,state:o,title:void 0}),l[5]=t,l[6]=r,l[7]=o,l[8]=s):s=l[8],s});function eM(e){let t,r,a,o,s,l,c,u,d,v,g=(0,i.c)(28),{children:w,onEditReference:y,onStructureParams:x,structureParams:b,searchParams:S,refs:j}=e,{state:_,resolvePathFromState:E}=(0,h.useRouter)();g[0]!==_._searchParams?(t=Object.fromEntries(_._searchParams||[]),g[0]=_._searchParams,g[1]=t):t=g[1];let C=(0,m.useUnique)(t);g[2]!==E||g[3]!==C||g[4]!==_?(r=e=>{let t=E(_),r=function(e){let t=["comment","inspect","instruction","pathKey","rev","since","template","view"];return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.entries(e).map(e=>{let[t,r]=e;return"".concat(t,"=").concat(r)}).join("&");return t.length?"?".concat(t):""}(Object.entries(e).filter(e=>{let[r]=e;return t.includes(r)}).reduce((e,t)=>{let[r,n]=t;return null==n?e:{...e,[r]:n}},{}))}({...C,...e});return"".concat(t).concat(r)},g[2]=E,g[3]=C,g[4]=_,g[5]=r):r=g[5];let T=r;g[6]===Symbol.for("react.memo_cache_sentinel")?(a={},g[6]=a):a=g[6],g[7]===Symbol.for("react.memo_cache_sentinel")?(o=[],g[7]=o):o=g[7],g[8]!==j||g[9]!==S?(s=(0,p.forwardRef)(function(e,t){let{childId:r,...i}=e,a=null==j?void 0:j.find(e=>e._id===r||(0,f.getPublishedId)(e._id)===r);return a?(0,n.jsx)(eU,{...i,ref:t,childId:r,childType:a._type,searchParams:S}):(console.warn('ChildLink: No document found for childId "'.concat(r,'"')),null)}),g[8]=j,g[9]=S,g[10]=s):s=g[10],g[11]!==S?(l=(0,p.forwardRef)(function(e,t){return(0,n.jsx)(eL,{...e,ref:t,searchParams:S})}),g[11]=S,g[12]=l):l=g[12],g[13]!==S?(c=(0,p.forwardRef)(function(e,t){return(0,n.jsx)(eI,{...e,ref:t,searchParams:S})}),g[13]=S,g[14]=c):c=g[14],g[15]!==y?(u=e=>{let{id:t,template:r,type:n,parentRefPath:i,version:a}=e;y({state:{id:t,type:n},params:{template:r.id,parentRefPath:(0,k.toString)(i),version:a}})},g[15]=y,g[16]=u):u=g[16],g[17]!==T||g[18]!==x||g[19]!==b||g[20]!==s||g[21]!==l||g[22]!==c||g[23]!==u?(d={index:0,groupIndex:0,siblingIndex:0,payload:a,params:b,hasGroupSiblings:!1,groupLength:1,routerPanesState:o,ChildLink:s,BackLink:l,ReferenceChildLink:c,ParameterizedLink:eW,closeCurrentAndAfter:eV,handleEditReference:u,replaceCurrent:eD,closeCurrent:eB,duplicateCurrent:eF,setView:eN,setParams:x,setPayload:ez,navigateIntent:eO,createPathWithParams:T},g[17]=T,g[18]=x,g[19]=b,g[20]=s,g[21]=l,g[22]=c,g[23]=u,g[24]=d):d=g[24];let R=d;return g[25]!==w||g[26]!==R?(v=(0,n.jsx)(P.PaneRouterContext.Provider,{value:R,children:w}),g[25]=w,g[26]=R,g[27]=v):v=g[27],v}function eO(e,t,r){console.warn("navigateIntent",e,t,r)}function ez(e){console.warn("setPayload",e)}function eN(e){console.warn("setView",e)}function eF(e){console.warn("duplicateCurrent",e)}function eB(){console.warn("closeCurrent")}function eD(e){console.warn("replaceCurrent",e)}function eV(){console.warn("closeCurrentAndAfter")}function eW(){throw Error("ParameterizedLink not implemented")}let eK=(0,v.styled)(j.PaneLayout)(Z()),e$=(0,v.styled)(u.Flex)(ee()),eH=(0,v.styled)(u.Code)(et());function eq(e){var t,r,a,s;let l,c,d,h,v,g,w,y,x,b=(0,i.c)(34),{mainDocumentState:P,onEditReference:S,onStructureParams:k,searchParams:C,refs:T}=e,{t:R}=(0,m.useTranslation)(o.presentationLocaleNamespace),{devMode:A}=(0,o.usePresentationTool)();if(b[0]!==(null==P||null==(t=P.document)?void 0:t._id)||b[1]!==T){let e;b[3]!==(null==P||null==(r=P.document)?void 0:r._id)?(e=e=>{var t;return(0,f.getPublishedId)(e._id)!==(null==P||null==(t=P.document)?void 0:t._id)},b[3]=null==P||null==(a=P.document)?void 0:a._id,b[4]=e):e=b[4],l=T.filter(e).map(eG),b[0]=null==P||null==(s=P.document)?void 0:s._id,b[1]=T,b[2]=l}else l=b[2];let U=l;b[5]!==U?(c={filter:"_id in $ids",params:{ids:U}},b[5]=U,b[6]=c):c=b[6],b[7]!==R?(d=R("document-list-pane.document-list.title"),b[7]=R,b[8]=d):d=b[8],b[9]!==c||b[10]!==d?(h={id:"$root",options:c,schemaTypeName:"",title:d,type:"documentList"},b[9]=c,b[10]=d,b[11]=h):h=b[11];let I=h,[L,M]=(0,p.useState)(null);b[12]===Symbol.for("react.memo_cache_sentinel")?(v=()=>M(null),b[12]=v):v=b[12];let O=v,[z]=(0,p.useState)(eX);if(b[13]===Symbol.for("react.memo_cache_sentinel")?(g=()=>M(null),b[13]=g):g=b[13],b[14]!==T?(w=[T],b[14]=T,b[15]=w):w=b[15],(0,p.useEffect)(g,w),L){let e,t,r;return b[16]!==R?(e=R("document-list-pane.error.text"),b[16]=R,b[17]=e):e=b[17],b[18]!==A||b[19]!==L||b[20]!==R?(t=A&&(0,n.jsx)(u.Card,{overflow:"auto",padding:3,radius:2,tone:"critical",children:(0,n.jsxs)(u.Stack,{space:3,children:[(0,n.jsx)(u.Label,{muted:!0,size:0,children:R("presentation-error.label")}),(0,n.jsx)(eH,{size:1,children:L.error.message})]})}),b[18]=A,b[19]=L,b[20]=R,b[21]=t):t=b[21],b[22]!==e||b[23]!==t?(r=(0,n.jsx)(eA,{flex:1,message:e,onRetry:O,children:t}),b[22]=e,b[23]=t,b[24]=r):r=b[24],r}return b[25]!==I?(y=(0,n.jsx)(e$,{direction:"column",flex:1,children:(0,n.jsx)(j.PaneContainer,{index:0,itemId:"$root",pane:I,paneKey:"$root"})}),b[25]=I,b[26]=y):y=b[26],b[27]!==S||b[28]!==k||b[29]!==T||b[30]!==C||b[31]!==z||b[32]!==y?(x=(0,n.jsx)(E.ErrorBoundary,{onCatch:M,children:(0,n.jsx)(eK,{children:(0,n.jsx)(_.StructureToolProvider,{children:(0,n.jsx)(eM,{onEditReference:S,onStructureParams:k,structureParams:z,searchParams:C,refs:T,children:y})})})}),b[27]=S,b[28]=k,b[29]=T,b[30]=C,b[31]=z,b[32]=y,b[33]=x):x=b[33],x}function eX(){return{}}function eG(e){return(0,f.getPublishedId)(e._id)}let eJ=(0,v.styled)(u.Code)(er());function eY(e){let t,r,a,s,l,c,d,v,g,w,y,x=(0,i.c)(40),{documentId:b,documentType:P,onFocusPath:S,onEditReference:_,onStructureParams:k,searchParams:C,structureParams:T}=e,{template:R,templateParams:A}=T,{t:U}=(0,m.useTranslation)(o.presentationLocaleNamespace),{devMode:I}=(0,o.usePresentationTool)();x[0]!==A?(t=(0,h.decodeJsonParams)(A),x[0]=A,x[1]=t):t=x[1],x[2]!==b||x[3]!==P||x[4]!==t||x[5]!==R?(r={id:b,type:P,template:R,templateParameters:t},x[2]=b,x[3]=P,x[4]=t,x[5]=R,x[6]=r):r=x[6],x[7]!==b||x[8]!==r?(a={id:b,options:r,title:"",type:"document"},x[7]=b,x[8]=r,x[9]=a):a=x[9];let L=a;x[10]!==b||x[11]!==P||x[12]!==S?(s=e=>S({id:b,type:P,path:f.studioPath.toString(e)}),x[10]=b,x[11]=P,x[12]=S,x[13]=s):s=x[13];let M=s,[O,z]=(0,p.useState)(null);x[14]===Symbol.for("react.memo_cache_sentinel")?(l=()=>z(null),x[14]=l):l=x[14];let N=l;if(x[15]===Symbol.for("react.memo_cache_sentinel")?(c=()=>{z(null)},x[15]=c):c=x[15],x[16]!==b||x[17]!==P||x[18]!==T?(d=[b,P,T],x[16]=b,x[17]=P,x[18]=T,x[19]=d):d=x[19],(0,p.useEffect)(c,d),O){let e,t,r;return x[20]!==U?(e=U("document-pane.error.text"),x[20]=U,x[21]=e):e=x[21],x[22]!==I||x[23]!==O||x[24]!==U?(t=I&&(0,n.jsx)(u.Card,{overflow:"auto",padding:3,radius:2,tone:"critical",children:(0,n.jsxs)(u.Stack,{space:3,children:[(0,n.jsx)(u.Label,{muted:!0,size:0,children:U("presentation-error.label")}),(0,n.jsx)(eJ,{size:1,children:O.error.message})]})}),x[22]=I,x[23]=O,x[24]=U,x[25]=t):t=x[25],x[26]!==e||x[27]!==t?(r=(0,n.jsx)(eA,{flex:1,message:e,onRetry:N,children:t}),x[26]=e,x[27]=t,x[28]=r):r=x[28],r}return x[29]===Symbol.for("react.memo_cache_sentinel")?(v={height:"100%"},x[29]=v):v=x[29],x[30]===Symbol.for("react.memo_cache_sentinel")?(g=(0,n.jsx)(o.PresentationSpinner,{}),x[30]=g):g=x[30],x[31]!==M||x[32]!==L?(w=(0,n.jsx)(p.Suspense,{fallback:g,children:(0,n.jsx)(j.DocumentPane,{paneKey:"document",index:1,itemId:"document",pane:L,onFocusPath:M})}),x[31]=M,x[32]=L,x[33]=w):w=x[33],x[34]!==_||x[35]!==k||x[36]!==C||x[37]!==T||x[38]!==w?(y=(0,n.jsx)(E.ErrorBoundary,{onCatch:z,children:(0,n.jsx)(j.PaneLayout,{style:v,children:(0,n.jsx)(eM,{searchParams:C,onEditReference:_,onStructureParams:k,structureParams:T,children:w})})}),x[34]=_,x[35]=k,x[36]=C,x[37]=T,x[38]=w,x[39]=y):y=x[39],y}function eQ(e){let t,r=(0,i.c)(8),{documentId:a,documentType:o,onFocusPath:s,onEditReference:l,onStructureParams:c,searchParams:u,structureParams:d}=e;return r[0]!==a||r[1]!==o||r[2]!==l||r[3]!==s||r[4]!==c||r[5]!==u||r[6]!==d?(t=(0,n.jsx)(_.StructureToolProvider,{children:(0,n.jsx)(eY,{documentId:a,documentType:o,onEditReference:l,onFocusPath:s,onStructureParams:c,searchParams:u,structureParams:d})}),r[0]=a,r[1]=o,r[2]=l,r[3]=s,r[4]=c,r[5]=u,r[6]=d,r[7]=t):t=r[7],t}function eZ(e){var t,r,a,s,l,c,d,f;let v,g,w,y,x,b,P=(0,i.c)(40),{documentId:j,documentType:_,mainDocumentState:E,onEditReference:k,onFocusPath:C,onStructureParams:T,refs:R,searchParams:A,structureParams:U}=e,{t:I}=(0,m.useTranslation)(o.presentationLocaleNamespace),L=(0,m.useSchema)();P[0]!==(null==E||null==(t=E.document)?void 0:t._id)||P[1]!==(null==E||null==(r=E.document)?void 0:r._type)||P[2]!==A?(v=e=>{var t,r;return(0,n.jsx)(h.StateLink,{...e,state:{id:null==E||null==(t=E.document)?void 0:t._id,type:null==E||null==(r=E.document)?void 0:r._type,_searchParams:Object.entries(A)}})},P[0]=null==E||null==(a=E.document)?void 0:a._id,P[1]=null==E||null==(s=E.document)?void 0:s._type,P[2]=A,P[3]=v):v=P[3];let M=v;P[4]!==(null==E||null==(l=E.document)?void 0:l._type)||P[5]!==L?(g=L.get((null==E||null==(c=E.document)?void 0:c._type)||"shoe"),P[4]=null==E||null==(d=E.document)?void 0:d._type,P[5]=L,P[6]=g):g=P[6];let O=g,z=function(e,t){let r,n,a,o=(0,i.c)(7),s=(0,m.useDocumentPreviewStore)();o[0]===Symbol.for("react.memo_cache_sentinel")?(r={},o[0]=r):r=o[0];let[l,c]=(0,p.useState)(r),{perspectiveStack:u}=(0,m.usePerspective)();return o[1]!==e||o[2]!==s||o[3]!==u||o[4]!==t?(n=()=>{if(!t)return;let r=(0,m.getPreviewStateObservable)(s,t,e,u).subscribe(e=>{c(e)});return()=>{null==r||r.unsubscribe()}},a=[s,t,e,u],o[1]=e,o[2]=s,o[3]=u,o[4]=t,o[5]=n,o[6]=a):(n=o[5],a=o[6]),(0,p.useEffect)(n,a),l}((null==E||null==(f=E.document)?void 0:f._id)||"",O);e:{let e,t,r,i;if(!(null==E?void 0:E.document)){w=null;break e}P[7]!==E.document||P[8]!==z.snapshot?(e=(0,m.getPreviewValueWithFallback)({snapshot:z.snapshot,fallback:E.document}),P[7]=E.document,P[8]=z.snapshot,P[9]=e):e=P[9],P[10]!==I?(t=I("main-document.label"),P[10]=I,P[11]=t):t=P[11],P[12]!==t?(r=(0,n.jsx)(u.Card,{padding:1,radius:2,shadow:1,children:(0,n.jsx)(u.Text,{muted:!0,size:0,weight:"medium",children:t})}),P[12]=t,P[13]=r):r=P[13],P[14]!==O||P[15]!==e||P[16]!==r?(i=(0,n.jsx)(m.SanityDefaultPreview,{...e,schemaType:O,status:r}),P[14]=O,P[15]=e,P[16]=r,P[17]=i):i=P[17],w=i}let N=w;if(j&&_){let e;return P[18]!==j||P[19]!==_||P[20]!==k||P[21]!==C||P[22]!==T||P[23]!==A||P[24]!==U?(e=(0,n.jsx)(eQ,{documentId:j,documentType:_,onEditReference:k,onFocusPath:C,onStructureParams:T,searchParams:A,structureParams:U}),P[18]=j,P[19]=_,P[20]=k,P[21]=C,P[22]=T,P[23]=A,P[24]=U,P[25]=e):e=P[25],e}return P[26]!==M||P[27]!==E||P[28]!==N||P[29]!==I?(y=E&&(0,n.jsx)(u.Card,{padding:3,tone:E.document?"inherit":"caution",children:E.document?(0,n.jsx)(m.PreviewCard,{__unstable_focusRing:!0,as:M,"data-as":"a",radius:2,sizing:"border",tone:"inherit",children:N}):(0,n.jsx)(u.Card,{padding:2,radius:2,tone:"inherit",children:(0,n.jsxs)(u.Flex,{gap:3,children:[(0,n.jsx)(u.Box,{flex:"none",children:(0,n.jsx)(u.Text,{size:1,children:(0,n.jsx)(S.WarningOutlineIcon,{})})}),(0,n.jsx)(u.Box,{flex:1,children:(0,n.jsx)(u.Text,{size:1,children:(0,n.jsx)(m.Translate,{t:I,i18nKey:"main-document.missing.text",components:{Code:"code"},values:{path:E.path}})})})]})})}),P[26]=M,P[27]=E,P[28]=N,P[29]=I,P[30]=y):y=P[30],P[31]!==E||P[32]!==k||P[33]!==T||P[34]!==R||P[35]!==A?(x=(0,n.jsx)(eq,{mainDocumentState:E,onEditReference:k,onStructureParams:T,searchParams:A,refs:R}),P[31]=E,P[32]=k,P[33]=T,P[34]=R,P[35]=A,P[36]=x):x=P[36],P[37]!==y||P[38]!==x?(b=(0,n.jsxs)(u.Flex,{direction:"column",flex:1,height:"fill",children:[y,x]}),P[37]=y,P[38]=x,P[39]=b):b=P[39],b}let e0=v.styled.div(en()),e1=v.styled.div(ei(),e=>{let{$disabled:t}=e;return t?"auto":"ew-resize"},e=>{let{$disabled:t}=e;return!t&&"\n    /* Hover effect */\n    & > span:nth-child(2) {\n      display: block;\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 9px;\n      bottom: 0;\n      background-color: var(--card-border-color);\n      opacity: 0;\n      transition: opacity 150ms;\n    }\n\n    @media (hover: hover) {\n      &:hover > span:nth-child(2) {\n        opacity: 0.2;\n      }\n    }\n  "}),e2=function(e){let t,r,a,o,s,l,c,u,d,m,f,h=(0,i.c)(27),{id:v,order:g,disabled:w}=e,y=void 0!==w&&w,x=(0,p.useRef)(null),b=(0,p.useContext)(P.PresentationPanelsContext);if(null===b)throw Error("Panel components must be rendered within a PanelGroup container");let S=function(e){let t,r=(0,i.c)(2);r[0]!==e?(t=()=>e||U(),r[0]=e,r[1]=t):t=r[1];let[n]=(0,p.useState)(t);return n}(v),{activeResizer:j,drag:_,startDragging:E,stopDragging:k,registerElement:C,unregisterElement:T}=b,R=j===S;if(null===b)throw Error("Panel components must be rendered within a PanelGroup container");h[0]!==S||h[1]!==E?(t=e=>{E(S,e.nativeEvent)},h[0]=S,h[1]=E,h[2]=t):t=h[2];let A=t;h[3]!==_||h[4]!==S?(r=e=>{_(S,e)},h[3]=_,h[4]=S,h[5]=r):r=h[5];let I=r;h[6]!==k?(a=()=>{x.current.blur(),k()},h[6]=k,h[7]=a):a=h[7];let L=a;return h[8]!==y||h[9]!==R||h[10]!==I||h[11]!==L?(o=()=>{if(!R||y)return;let e=function(){let e=document.body.style,t=document.documentElement.style,{cursor:r}=t,{userSelect:n}=e;return t.cursor="ew-resize",e.userSelect="none",()=>{r?t.cursor=r:t.removeProperty("cursor"),n?e.userSelect=n:e.removeProperty("user-select")}}();return window.addEventListener("mousemove",I),window.addEventListener("mouseup",L),window.addEventListener("contextmenu",L),()=>{e(),window.removeEventListener("mousemove",I),window.removeEventListener("mouseup",L),window.removeEventListener("contextmenu",L)}},s=[y,R,I,L],h[8]=y,h[9]=R,h[10]=I,h[11]=L,h[12]=o,h[13]=s):(o=h[12],s=h[13]),(0,p.useEffect)(o,s),h[14]!==S||h[15]!==g||h[16]!==C||h[17]!==T?(l=()=>(C(S,{id:S,order:g,type:"resizer",el:x}),()=>{T(S)}),c=[S,g,C,T],h[14]=S,h[15]=g,h[16]=C,h[17]=T,h[18]=l,h[19]=c):(l=h[18],c=h[19]),(0,p.useLayoutEffect)(l,c),h[20]===Symbol.for("react.memo_cache_sentinel")?(d=(0,n.jsx)("span",{}),u=(0,n.jsx)("span",{}),h[20]=u,h[21]=d):(u=h[20],d=h[21]),h[22]!==y?(m=(0,n.jsxs)(e1,{$disabled:y,children:[d,u]}),h[22]=y,h[23]=m):m=h[23],h[24]!==A||h[25]!==m?(f=(0,n.jsx)(e0,{onMouseDown:A,ref:x,children:m}),h[24]=A,h[25]=m,h[26]=f):f=h[26],f},e3=e=>{let t,r,a,o=(0,i.c)(8),{documentId:s,setDisplayedDocument:l,getCommentIntent:c}=e;return o[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,n.jsx)(e2,{order:4}),o[0]=t):t=o[0],o[1]!==c||o[2]!==e.children?(r=(0,n.jsx)(m.CommentsIntentProvider,{getIntent:c,children:e.children}),o[1]=c,o[2]=e.children,o[3]=r):r=o[3],o[4]!==s||o[5]!==l||o[6]!==r?(a=(0,n.jsxs)(n.Fragment,{children:[t,(0,n.jsx)(eh,{id:"content",minWidth:325,order:5,children:(0,n.jsx)(C.DisplayedDocumentBroadcasterProvider,{documentId:s,setDisplayedDocument:l,children:r})})]}),o[4]=s,o[5]=l,o[6]=r,o[7]=a):a=o[7],a},e4=e=>{let t,r,a=(0,i.c)(15),{documentId:o,documentsOnPage:s,documentType:l,getCommentIntent:c,mainDocumentState:u,onEditReference:d,onFocusPath:p,onStructureParams:m,searchParams:f,setDisplayedDocument:h,structureParams:v}=e;return a[0]!==o||a[1]!==l||a[2]!==s||a[3]!==u||a[4]!==d||a[5]!==p||a[6]!==m||a[7]!==f||a[8]!==v?(t=(0,n.jsx)(eZ,{documentId:o,documentType:l,mainDocumentState:u,onEditReference:d,onFocusPath:p,onStructureParams:m,refs:s,searchParams:f,structureParams:v}),a[0]=o,a[1]=l,a[2]=s,a[3]=u,a[4]=d,a[5]=p,a[6]=m,a[7]=f,a[8]=v,a[9]=t):t=a[9],a[10]!==o||a[11]!==c||a[12]!==h||a[13]!==t?(r=(0,n.jsx)(e3,{documentId:o,getCommentIntent:c,setDisplayedDocument:h,children:t}),a[10]=o,a[11]=c,a[12]=h,a[13]=t,a[14]=r):r=a[14],r},e5=function(e){let t,r,a=(0,i.c)(5),{children:o,navigate:s}=e;a[0]!==s?(t=(e,t)=>{if(e||t){let r={};e&&(r.params={preview:e}),t&&(r.state=t),s(r)}},a[0]=s,a[1]=t):t=a[1];let l=t;return a[2]!==o||a[3]!==l?(r=(0,n.jsx)(P.PresentationNavigateContext.Provider,{value:l,children:o}),a[2]=o,a[3]=l,a[4]=r):r=a[4],r};function e6(e){return!e}let e7=(0,p.memo)(function(e){let t,r,a,o,s=(0,i.c)(11),{minWidth:l,maxWidth:c,component:u}=e,d=null!=l&&null!=c&&l===c;return s[0]!==u?(t=(0,n.jsx)(u,{}),s[0]=u,s[1]=t):t=s[1],s[2]!==c||s[3]!==l||s[4]!==t?(r=(0,n.jsx)(eh,{id:"navigator",minWidth:l,maxWidth:c,order:1,children:t}),s[2]=c,s[3]=l,s[4]=t,s[5]=r):r=s[5],s[6]!==d?(a=(0,n.jsx)(e2,{order:2,disabled:d}),s[6]=d,s[7]=a):a=s[7],s[8]!==r||s[9]!==a?(o=(0,n.jsxs)(n.Fragment,{children:[r,a]}),s[8]=r,s[9]=a,s[10]=o):o=s[10],o}),e8=function(e){let t,r=(0,i.c)(3),{children:a,params:o}=e;return r[0]!==a||r[1]!==o?(t=(0,n.jsx)(P.PresentationParamsContext.Provider,{value:o,children:a}),r[0]=a,r[1]=o,r[2]=t):t=r[2],t},e9=function(e){let t,r,a=(0,i.c)(10),{children:o,devMode:s,name:l,navigate:c,params:u,searchParams:d,structureParams:p}=e;a[0]!==s||a[1]!==l||a[2]!==c||a[3]!==u||a[4]!==d||a[5]!==p?(t={devMode:s,name:l,navigate:c,params:u,searchParams:d,structureParams:p},a[0]=s,a[1]=l,a[2]=c,a[3]=u,a[4]=d,a[5]=p,a[6]=t):t=a[6];let m=t;return a[7]!==o||a[8]!==m?(r=(0,n.jsx)(P.PresentationContext.Provider,{value:m,children:o}),a[7]=o,a[8]=m,a[9]=r):r=a[9],r};function te(e){let t=(0,a.useSelector)(e,tt);if(!Array.isArray(t))throw TypeError("allowPatterns must be an array");return t}function tt(e){return e.context.allowOrigins}function tr(e){return Array.isArray(e)?e.join(","):e}function tn(){let e,t=(0,i.c)(2),r=(0,p.useId)();return t[0]!==r?(e=r.startsWith(":")?r.replace(/^:(.+):$/,"«$1»"):r,t[0]=r,t[1]=e):e=t[1],e}let ti=(0,p.forwardRef)(function(e,t){let r,a,o,s,l,c,u,d,m=(0,i.c)(19),{animate:f,initial:h,onLoad:v,preventClick:g,src:w,variants:y,style:x}=e,b=(0,p.useRef)(null);m[0]===Symbol.for("react.memo_cache_sentinel")?(r=()=>b.current,m[0]=r):r=m[0],(0,p.useImperativeHandle)(t,r),m[1]===Symbol.for("react.memo_cache_sentinel")?(a=()=>{if(!b.current)return;let e=b.current,t=function(){e===document.activeElement&&e.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0}))};return window.addEventListener("blur",t),()=>{window.removeEventListener("blur",t)}},o=[],m[1]=a,m[2]=o):(a=m[1],o=m[2]),(0,p.useEffect)(a,o);let P=tn();return m[3]!==x||m[4]!==P?(s={...x,viewTransitionName:P},m[3]=x,m[4]=P,m[5]=s):s=m[5],m[6]!==f||m[7]!==h||m[8]!==v||m[9]!==w||m[10]!==s||m[11]!==y?(l=(0,n.jsx)(ta,{style:s,animate:f,initial:h,onLoad:v,ref:b,src:w,variants:y}),m[6]=f,m[7]=h,m[8]=v,m[9]=w,m[10]=s,m[11]=y,m[12]=l):l=m[12],m[13]!==g?(c=g&&(0,n.jsx)(to,{}),m[13]=g,m[14]=c):c=m[14],m[15]===Symbol.for("react.memo_cache_sentinel")?(u=(0,n.jsx)(ts,{}),m[15]=u):u=m[15],m[16]!==l||m[17]!==c?(d=(0,n.jsxs)(n.Fragment,{children:[l,c,u]}),m[16]=l,m[17]=c,m[18]=d):d=m[18],d}),ta=I.motion.create(v.styled.iframe(ea())),to=(0,v.styled)(u.Box)(eo()),ts=(0,v.createGlobalStyle)(es());function tl(e){let t,r,a,s,l,d,p,f=(0,i.c)(16),{openPopup:h,previewLocationOrigin:v,previewLocationRoute:g,perspective:w,targetOrigin:y}=e,x=new URL(g,v||y);x.searchParams.set(c.urlSearchParamPreviewPerspective,tr(w));let{pathname:b,search:P}=x,j="".concat(v).concat(b).concat(P),{t:_}=(0,m.useTranslation)(o.presentationLocaleNamespace);f[0]!==h?(t=e=>{e.preventDefault(),h(e.currentTarget.href)},f[0]=h,f[1]=t):t=f[1];let k=t;return f[2]!==_?(r=_("share-url.menu-item.open.text"),f[2]=_,f[3]=r):r=f[3],f[4]!==r?(a=(0,n.jsx)(u.Text,{size:1,children:r}),f[4]=r,f[5]=a):a=f[5],f[6]===Symbol.for("react.memo_cache_sentinel")?(s=["bottom-start"],f[6]=s):s=f[6],f[7]!==_?(l=_("share-url.menu-item.open.text"),f[7]=_,f[8]=l):l=f[8],f[9]!==k||f[10]!==j||f[11]!==l?(d=(0,n.jsx)(E.Button,{as:"a","aria-label":l,icon:S.LaunchIcon,mode:"bleed",href:j,rel:"opener",target:"_blank",tooltipProps:null,onClick:k}),f[9]=k,f[10]=j,f[11]=l,f[12]=d):d=f[12],f[13]!==a||f[14]!==d?(p=(0,n.jsx)(E.Tooltip,{animate:!0,content:a,fallbackPlacements:s,placement:"bottom",portal:!0,children:d}),f[13]=a,f[14]=d,f[15]=p):p=f[15],p}function tc(e){let t=(0,a.useSelector)(e,tu);if(!t)throw TypeError("targetOrigin is required");return t}function tu(e){var t;return null==(t=e.context.previewUrl)?void 0:t.origin}function td(e){var t;let r,a,s,l,c,d,f,h,v,g,w=(0,i.c)(32),{fontSize:y,onChange:x,padding:b,prefix:P,suffix:j,value:_,previewUrlRef:E}=e,k=void 0===y?1:y,C=void 0===b?3:b,T=te(E),R=tc(E),{t:A}=(0,m.useTranslation)(o.presentationLocaleNamespace),{basePath:U}=(null==(t=(0,m.useActiveWorkspace)())?void 0:t.activeWorkspace)||{},I=void 0===U?"/":U,L=(0,p.useRef)(null),[M,O]=(0,p.useState)(void 0),[z,N]=(0,p.useState)(void 0);w[0]===Symbol.for("react.memo_cache_sentinel")?(r=e=>{O(e.currentTarget.value)},w[0]=r):r=w[0];let F=r;w[1]!==T||w[2]!==I||w[3]!==x||w[4]!==M||w[5]!==A||w[6]!==R?(a=e=>{if("Enter"===e.key){var t;if(void 0===M)return;let r=M;try{r=new URL(M,R).toString()}catch(e){}if(Array.isArray(T)){if(!T.some(e=>e.test(r))){N(A("preview-location-input.error",{origin:R,context:"origin-not-allowed"})),e.currentTarget.reportValidity();return}}else if(!R&&(r.startsWith("".concat(I,"/"))||r===I))return void N(A("preview-location-input.error",{basePath:I,context:"same-base-path"}));let n=r===R?"".concat(R,"/"):r;N(void 0),O(void 0),x(n),null==(t=L.current)||t.blur()}"Escape"===e.key&&(N(void 0),O(void 0))},w[1]=T,w[2]=I,w[3]=x,w[4]=M,w[5]=A,w[6]=R,w[7]=a):a=w[7];let B=a;w[8]===Symbol.for("react.memo_cache_sentinel")?(s=()=>{N(void 0),O(void 0)},w[8]=s):s=w[8];let D=s;w[9]!==R||w[10]!==_?(l=()=>{N(void 0);let e=_;try{e=new URL(_,R).toString()}catch(e){}O(e)},w[9]=R,w[10]=_,w[11]=l):l=w[11];let V=l;w[12]===Symbol.for("react.memo_cache_sentinel")?(c=()=>{N(void 0),O(void 0)},w[12]=c):c=w[12],w[13]!==R||w[14]!==_?(d=[R,_],w[13]=R,w[14]=_,w[15]=d):d=w[15],(0,p.useEffect)(c,d),w[16]===Symbol.for("react.memo_cache_sentinel")?(f={icon:S.ResetIcon},w[16]=f):f=w[16];let W=z?f:void 0;return w[17]===Symbol.for("react.memo_cache_sentinel")?(h={zIndex:1},w[17]=h):h=w[17],w[18]!==M||w[19]!==R||w[20]!==_?(v=void 0===M?new URL(_,R).toString():M,w[18]=M,w[19]=R,w[20]=_,w[21]=v):v=w[21],w[22]!==z||w[23]!==k||w[24]!==V||w[25]!==B||w[26]!==C||w[27]!==P||w[28]!==j||w[29]!==W||w[30]!==v?(g=(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(u.TextInput,{clearButton:W,customValidity:z,fontSize:k,onBlur:D,onClear:V,onChange:F,onKeyDownCapture:B,padding:C,prefix:P,style:h,radius:2,ref:L,space:C,suffix:j,value:v})}),w[22]=z,w[23]=k,w[24]=V,w[25]=B,w[26]=C,w[27]=P,w[28]=j,w[29]=W,w[30]=v,w[31]=g):g=w[31],g}let tp=(0,p.lazy)(()=>e.A(761946)),tm=(0,v.styled)(B.SanityMonogram)(el(),24,24),tf=I.motion.create(u.Spinner),th=I.motion.create(u.Text),tv=I.motion.create(tm),tg=(0,p.memo)(function(e){let{canToggleSharePreviewAccess:t,canUseSharedPreviewAccess:r,initialUrl:i,previewLocationRoute:a,perspective:s}=e,{t:l}=(0,m.useTranslation)(o.presentationLocaleNamespace),{push:f}=(0,d.useToast)(),h=(0,m.useClient)({apiVersion:o.API_VERSION}),v=(0,m.useCurrentUser)(),[g,w]=(0,p.useState)(!0),[y,x]=(0,p.useState)(!1),[b,P]=(0,p.useState)(!1),[j,_]=(0,p.useState)(null),k=y||b||g,C=(0,p.useMemo)(()=>j?function(e,t,r,n){let i=new URL(e),{searchParams:a}=i;return t&&(a.set(c.urlSearchParamPreviewSecret,t),a.set(c.urlSearchParamPreviewPathname,r)),a.set(c.urlSearchParamPreviewPerspective,n),i}(i,j,a,tr(s)):null,[i,s,a,j]),[T,R]=(0,p.useState)(null);if(T)throw T;let A=(0,p.useCallback)(()=>{f({closable:!0,status:"warning",title:l("share-preview-menu.error_toggle-sharing",{context:"toggle-sharing"})})},[f,l]),U=(0,p.useCallback)(async()=>{try{P(!0),await W(h,"sanity/presentation",typeof window>"u"?"":location.href,null==v?void 0:v.id),_(null)}catch(e){R(e)}finally{P(!1)}},[h,null==v?void 0:v.id]),I=(0,p.useCallback)(async()=>{try{x(!0);let e=await V(h,"sanity/presentation",typeof window>"u"?"":location.href,null==v?void 0:v.id);_(e.secret)}catch(e){R(e)}finally{x(!1)}},[h,null==v?void 0:v.id]),M=(0,p.useCallback)(()=>{try{if(!C)throw Error("No URL to copy");navigator.clipboard.writeText(C.toString()),f({closable:!0,status:"success",title:l("share-url.clipboard.status",{context:"success"})})}catch(e){R(e)}},[f,l,C]);return(0,p.useEffect)(()=>{let e=new AbortController,t=[];async function r(e,r){let{result:n,syncTags:i}=await h.fetch(c.fetchSharedAccessQuery,{},{filterResponse:!1,lastLiveEventId:e,tag:"presentation.fetch-shared-access-secret"});Array.isArray(i)&&(t=i),r.aborted||_(n)}let n=h.live.events().subscribe({next:n=>{"message"===n.type&&(e.abort(),e=new AbortController,n.tags.some(e=>t.includes(e))&&r(n.id,e.signal))},error:R});return r(null,e.signal).finally(()=>w(!1)),()=>{n.unsubscribe(),e.abort()}},[h]),(0,n.jsx)(E.MenuButton,{button:(0,n.jsx)(E.Button,{"aria-label":l("preview-frame.share-button.aria-label"),icon:S.ShareIcon,mode:"bleed",tooltipProps:null}),id:"share-menu",menu:(0,n.jsx)(u.Menu,{style:{maxWidth:248},padding:r?void 0:0,children:r?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("label",{style:{cursor:"pointer"},children:(0,n.jsxs)(u.Grid,{columns:2,rows:2,gapX:3,gapY:1,style:{justifyContent:"center",alignItems:"center",gridTemplateColumns:"min-content 1fr",gridTemplateRows:"min-content"},paddingTop:3,paddingX:3,children:[(0,n.jsx)(E.Tooltip,{animate:!0,content:(0,n.jsx)(u.Text,{size:1,children:l("share-preview-menu.toggle-button.tooltip",{context:C?"disable":"enable"})}),fallbackPlacements:["bottom-start"],placement:"bottom",portal:!0,children:(0,n.jsx)(u.Switch,{checked:y||null!==C&&!b,readOnly:y||b,indeterminate:g,onChange:t?C?U:I:A})}),(0,n.jsx)(u.Text,{size:1,weight:"medium",children:l("share-preview-menu.toggle-button.label",{context:"first-line"})}),(0,n.jsx)("span",{}),(0,n.jsx)(u.Text,{muted:!0,size:1,children:l("share-preview-menu.toggle-button.label",{context:"second-line"})})]})}),(0,n.jsx)(u.Box,{padding:3,paddingTop:2,children:(0,n.jsxs)(u.Stack,{space:3,children:[(0,n.jsx)(u.Card,{tone:k||!C?"transparent":void 0,style:{position:"relative",aspectRatio:"1 / 1",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,n.jsx)(L.AnimatePresence,{children:k?(0,n.jsx)(tf,{muted:!0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}):C?(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(p.Suspense,{fallback:(0,n.jsx)(u.Spinner,{}),children:[(0,n.jsx)(tp,{title:l("share-preview-menu.qr-code.title",{url:C.toString()}),value:C.toString(),size:224,color:"var(--card-fg-color)",logoSize:40}),(0,n.jsx)(tv,{initial:{opacity:-.5},animate:{opacity:1.5},exit:{opacity:0}})]})}):(0,n.jsx)(th,{muted:!0,size:1,style:{maxWidth:"100px",textWrap:"pretty",textAlign:"center"},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:l("share-preview-menu.qr-code.placeholder")})})}),(0,n.jsx)(u.Text,{muted:!0,size:1,children:l("share-preview-menu.qr-code.instructions")})]})}),(0,n.jsx)(u.MenuDivider,{}),(0,n.jsx)(E.MenuItem,{disabled:!C||b,icon:S.CopyIcon,onClick:M,text:l("share-preview-menu.copy-url.text")})]}):(0,n.jsx)(u.Card,{padding:2,tone:"caution",radius:3,children:(0,n.jsx)(u.Text,{style:{textWrap:"pretty"},children:l("share-preview-menu.error",{context:"missing-grants"})})})}),popover:{constrainSize:!0,placement:"bottom",portal:!0}})});tg.displayName="Memo(SharePreviewMenu)";let tw=e=>{let t,r,s,l,d,p,f,h,v,g,w,y,x,b,P,j,_,k,C,T,R,A,U,I,L,M,O,z,N,F,B,D,V,W,K,$=(0,i.c)(107),{canSharePreviewAccess:H,canToggleSharePreviewAccess:q,canUseSharedPreviewAccess:X,iframeRef:G,initialUrl:J,navigatorEnabled:Y,onPathChange:Q,onRefresh:Z,openPopup:ee,overlaysConnection:et,presentationRef:er,perspective:en,previewUrl:ei,setViewport:ea,targetOrigin:eo,toggleNavigator:es,toggleOverlay:el,viewport:ec,previewUrlRef:eu}=e,{t:ed}=(0,m.useTranslation)(o.presentationLocaleNamespace);$[0]!==ea||$[1]!==ec?(t=()=>ea("desktop"===ec?"mobile":"desktop"),$[0]=ea,$[1]=ec,$[2]=t):t=$[2];let ep=t,em=eo===location.origin?"":eo;$[3]!==G||$[4]!==Z||$[5]!==er||$[6]!==ei||$[7]!==eo?(r=()=>{Z(()=>{G.current&&(er.send({type:"iframe reload"}),Object.assign(G.current,{src:"".concat(eo).concat(ei||"/")}))})},$[3]=G,$[4]=Z,$[5]=er,$[6]=ei,$[7]=eo,$[8]=r):r=$[8];let ef=r,eh=(0,a.useSelector)(er,tb),ev=(0,a.useSelector)(er,tP),eg=(0,a.useSelector)(er,tS),ew=(0,a.useSelector)(er,tj),ey=(0,a.useSelector)(er,t_),{pathname:ex,search:eb}=function(e){let t=new URL(e),{searchParams:r}=t;return r.delete(c.urlSearchParamPreviewPathname),r.delete(c.urlSearchParamPreviewSecret),r.delete(c.urlSearchParamPreviewPerspective),r.delete(c.urlSearchParamVercelProtectionBypass),r.delete(c.urlSearchParamVercelSetBypassCookie),t}(new URL(ei||"/",eo)),eP="".concat(ex).concat(eb),eS=tn(),ej=(0,a.useSelector)(eu,tE);$[9]===Symbol.for("react.memo_cache_sentinel")?(s={width:"100%"},$[9]=s):s=$[9],$[10]!==Y||$[11]!==ed||$[12]!==es?(l=es&&(0,n.jsx)(E.Button,{"aria-label":ed("preview-frame.navigator.toggle-button.aria-label"),icon:S.PanelLeftIcon,mode:"bleed",onClick:es,selected:Y,tooltipProps:{content:(0,n.jsx)(u.Text,{size:1,children:ed("preview-frame.navigator.toggle-button.tooltip")}),fallbackPlacements:["bottom-start"],placement:"bottom"}}),$[10]=Y,$[11]=ed,$[12]=es,$[13]=l):l=$[13],$[14]===Symbol.for("react.memo_cache_sentinel")?(d={whiteSpace:"nowrap"},$[14]=d):d=$[14];let e_=ey?"disable":"enable";$[15]!==ed||$[16]!==e_?(p=ed("preview-frame.overlay.toggle-button.tooltip",{context:e_}),$[15]=ed,$[16]=e_,$[17]=p):p=$[17],$[18]!==p?(f=(0,n.jsx)(u.Box,{padding:1,children:(0,n.jsx)(u.Text,{size:1,children:p})}),$[18]=p,$[19]=f):f=$[19],$[20]===Symbol.for("react.memo_cache_sentinel")?(h=(0,n.jsx)(u.Box,{paddingY:1,children:(0,n.jsx)(u.Hotkeys,{keys:["Alt"],style:{marginTop:-4,marginBottom:-4}})}),$[20]=h):h=$[20],$[21]!==f?(v=(0,n.jsxs)(u.Flex,{align:"center",style:d,children:[f,h]}),$[21]=f,$[22]=v):v=$[22],$[23]===Symbol.for("react.memo_cache_sentinel")?(g=["bottom-start"],$[23]=g):g=$[23],$[24]===Symbol.for("react.memo_cache_sentinel")?(w={lineHeight:0,borderRadius:999,userSelect:"none"},$[24]=w):w=$[24];let eE=ey?"transparent":void 0;$[25]===Symbol.for("react.memo_cache_sentinel")?(y={margin:-4},$[25]=y):y=$[25];let ek=!ev,eC=eh||"connected"!==et;$[26]!==ey||$[27]!==ek||$[28]!==eC||$[29]!==el?(x=(0,n.jsx)("div",{style:y,children:(0,n.jsx)(u.Switch,{indeterminate:ek,checked:ey,onChange:el,disabled:eC})}),$[26]=ey,$[27]=ek,$[28]=eC,$[29]=el,$[30]=x):x=$[30];let eT=!ey;$[31]!==ed?(b=ed("preview-frame.overlay.toggle-button.text"),$[31]=ed,$[32]=b):b=$[32],$[33]!==eT||$[34]!==b?(P=(0,n.jsx)(u.Box,{children:(0,n.jsx)(u.Text,{muted:eT,size:1,weight:"medium",children:b})}),$[33]=eT,$[34]=b,$[35]=P):P=$[35],$[36]!==x||$[37]!==P?(j=(0,n.jsxs)(u.Flex,{align:"center",gap:3,children:[x,P]}),$[36]=x,$[37]=P,$[38]=j):j=$[38],$[39]!==eE||$[40]!==j?(_=(0,n.jsx)(u.Card,{as:"label",flex:"none",padding:3,marginX:1,style:w,tone:eE,children:j}),$[39]=eE,$[40]=j,$[41]=_):_=$[41],$[42]!==_||$[43]!==v?(k=(0,n.jsx)(E.Tooltip,{animate:!0,content:v,fallbackPlacements:g,placement:"bottom",portal:!0,children:_}),$[42]=_,$[43]=v,$[44]=k):k=$[44],$[45]!==ev||$[46]!==eh||$[47]!==eg||$[48]!==ew||$[49]!==ed?(C=ev?ed("preview-frame.refresh-button.tooltip"):ed("preview-frame.status",{context:eh?"loading":eg?"refreshing":ew?"reloading":"unknown"}),$[45]=ev,$[46]=eh,$[47]=eg,$[48]=ew,$[49]=ed,$[50]=C):C=$[50],$[51]!==C?(T=(0,n.jsx)(u.Text,{size:1,children:C}),$[51]=C,$[52]=T):T=$[52],$[53]===Symbol.for("react.memo_cache_sentinel")?(R=["bottom-end"],$[53]=R):R=$[53],$[54]!==ed?(A=ed("preview-frame.refresh-button.aria-label"),$[54]=ed,$[55]=A):A=$[55];let eR=ew||eg||ej;$[56]!==ef||$[57]!==A||$[58]!==eR?(U=(0,n.jsx)(E.Button,{"aria-label":A,icon:S.RefreshIcon,mode:"bleed",loading:eR,onClick:ef,tooltipProps:null}),$[56]=ef,$[57]=A,$[58]=eR,$[59]=U):U=$[59],$[60]!==T||$[61]!==U?(I=(0,n.jsx)(u.Box,{padding:1,children:(0,n.jsx)(E.Tooltip,{animate:!0,content:T,fallbackPlacements:R,placement:"bottom",portal:!0,children:U})}),$[60]=T,$[61]=U,$[62]=I):I=$[62],$[63]!==ee||$[64]!==en||$[65]!==em||$[66]!==eP||$[67]!==eo?(L=(0,n.jsx)(u.Box,{padding:1,children:(0,n.jsx)(tl,{openPopup:ee,previewLocationOrigin:em,previewLocationRoute:eP,perspective:en,targetOrigin:eo})}),$[63]=ee,$[64]=en,$[65]=em,$[66]=eP,$[67]=eo,$[68]=L):L=$[68],$[69]!==Q||$[70]!==eP||$[71]!==eu||$[72]!==I||$[73]!==L?(M=(0,n.jsx)(u.Box,{flex:1,children:(0,n.jsx)(td,{previewUrlRef:eu,prefix:I,onChange:Q,suffix:L,value:eP})}),$[69]=Q,$[70]=eP,$[71]=eu,$[72]=I,$[73]=L,$[74]=M):M=$[74],$[75]!==eS?(O=e=>{null==e||e.style.setProperty("view-transition-name",eS)},$[75]=eS,$[76]=O):O=$[76];let eA="desktop"===ec?"narrow":"full";$[77]!==ed||$[78]!==eA?(z=ed("preview-frame.viewport-button.tooltip",{context:eA}),$[77]=ed,$[78]=eA,$[79]=z):z=$[79],$[80]!==z?(N=(0,n.jsx)(u.Text,{size:1,children:z}),$[80]=z,$[81]=N):N=$[81],$[82]===Symbol.for("react.memo_cache_sentinel")?(F=["bottom-start"],$[82]=F):F=$[82],$[83]!==ed?(B=ed("preview-frame.viewport-button.aria-label"),$[83]=ed,$[84]=B):B=$[84];let eU="desktop"===ec?S.MobileDeviceIcon:S.DesktopIcon;return $[85]!==B||$[86]!==eU||$[87]!==ep||$[88]!==ec?(D=(0,n.jsx)(E.Button,{"data-testid":"preview-viewport-toggle","data-viewport":ec,"aria-label":B,icon:eU,mode:"bleed",onClick:ep,tooltipProps:null}),$[85]=B,$[86]=eU,$[87]=ep,$[88]=ec,$[89]=D):D=$[89],$[90]!==O||$[91]!==N||$[92]!==D?(V=(0,n.jsx)(u.Flex,{align:"center",flex:"none",gap:1,children:(0,n.jsx)(E.Tooltip,{animate:!0,ref:O,content:N,fallbackPlacements:F,placement:"bottom",portal:!0,children:D})}),$[90]=O,$[91]=N,$[92]=D,$[93]=V):V=$[93],$[94]!==H||$[95]!==q||$[96]!==X||$[97]!==J||$[98]!==en||$[99]!==eP?(W=H&&(0,n.jsx)(u.Flex,{align:"center",flex:"none",gap:1,children:(0,n.jsx)(tg,{canToggleSharePreviewAccess:q,canUseSharedPreviewAccess:X,previewLocationRoute:eP,initialUrl:J,perspective:en})}),$[94]=H,$[95]=q,$[96]=X,$[97]=J,$[98]=en,$[99]=eP,$[100]=W):W=$[100],$[101]!==k||$[102]!==l||$[103]!==M||$[104]!==V||$[105]!==W?(K=(0,n.jsxs)(u.Flex,{align:"center",gap:1,paddingX:1,style:s,children:[l,k,M,V,W]}),$[101]=k,$[102]=l,$[103]=M,$[104]=V,$[105]=W,$[106]=K):K=$[106],K};function ty(e){var t;let r,a,o,s,l=(0,i.c)(7),c=tx,d=null==(t=e.options)?void 0:t.component;l[0]!==d||l[1]!==e?(r=d?(0,n.jsx)(d,{...e,renderDefault:c}):c(e),l[0]=d,l[1]=e,l[2]=r):r=l[2];let p=r;return l[3]===Symbol.for("react.memo_cache_sentinel")?(a={position:"relative"},l[3]=a):a=l[3],l[4]===Symbol.for("react.memo_cache_sentinel")?(o={minHeight:0},l[4]=o):o=l[4],l[5]!==p?(s=(0,n.jsx)(u.Card,{flex:"none",padding:2,borderBottom:!0,style:a,children:(0,n.jsx)(u.Flex,{align:"center",style:o,children:p})}),l[5]=p,l[6]=s):s=l[6],s}function tx(e){return(0,n.jsx)(tw,{...e})}function tb(e){return e.matches("loading")}function tP(e){return e.matches("loaded")}function tS(e){return e.matches({loaded:"refreshing"})}function tj(e){return e.matches({loaded:"reloading"})}function t_(e){return e.context.visualEditingOverlaysEnabled}function tE(e){return e.hasTag("busy")}let tk=I.motion.create(u.Flex),tC=(0,p.memo)((0,p.forwardRef)(function(e,t){let{header:r,initialUrl:i,loadersConnection:f,overlaysConnection:h,perspective:v,viewport:w,vercelProtectionBypass:y,presentationRef:x,previewUrlRef:b}=e,[P,S]=(0,p.useState)(null),j=tr(null===P?v:P),_=(0,p.useMemo)(()=>{let e=new URL(i);return e.searchParams.get(c.urlSearchParamPreviewPerspective)||e.searchParams.set(c.urlSearchParamPreviewPerspective,j),(y||e.searchParams.get(c.urlSearchParamVercelProtectionBypass))&&e.searchParams.set(c.urlSearchParamVercelSetBypassCookie,"samesitenone"),y&&!e.searchParams.get(c.urlSearchParamVercelProtectionBypass)&&e.searchParams.set(c.urlSearchParamVercelProtectionBypass,y),e},[i,j,y]);(0,p.useEffect)(()=>{"connected"===f&&S(e=>null===e?v:e)},[f,v]);let{t:k}=(0,m.useTranslation)(o.presentationLocaleNamespace),{devMode:C}=(0,o.usePresentationTool)(),T=(0,u.usePrefersReducedMotion)(),R=(0,p.useRef)(null),A=(0,n.jsx)(ty,{...e,iframeRef:R,options:r});(0,p.useImperativeHandle)(t,()=>R.current);let U=(0,a.useSelector)(x,e=>e.matches("loading")||e.matches({loaded:"reloading"})),[I,M]=(0,p.useState)(!1),O=(0,a.useSelector)(x,e=>e.matches({loaded:"refreshing"})),[z,B]=(0,p.useState)(!1),D=U||O||"connecting"===h,V=(0,p.useCallback)(()=>{R.current&&(R.current.src=_.toString(),x.send({type:"iframe reload"}))},[x,_]),W=(0,p.useCallback)(()=>{$(!0)},[]),[K,$]=(0,p.useState)(!1),[H,q]=(0,p.useState)(!1);(0,p.useEffect)(()=>{if(!(U||O)&&("connecting"===h||"reconnecting"===h)){let e=setTimeout(()=>{q(!0)},5e3);return()=>clearTimeout(e)}},[h,U,O]),(0,p.useEffect)(()=>{if(!(U||O||!H)){if("connected"===h&&(B(!1),q(!1),M(!1),$(!1)),"connecting"===h){let e=setTimeout(()=>{M(!0),console.error("Unable to connect to visual editing. Make sure you've setup '@sanity/visual-editing' correctly")},o.MAX_TIME_TO_OVERLAYS_CONNECTION);return()=>clearTimeout(e)}if("reconnecting"===h){let e=setTimeout(()=>{M(!0),B(!0)},o.MAX_TIME_TO_OVERLAYS_CONNECTION);return()=>clearTimeout(e)}}},[U,h,O,H]);let X=(0,p.useCallback)(()=>{x.send({type:"iframe loaded"})},[x]),G=(0,p.useMemo)(()=>(U||"connecting"===h&&!O)&&!K,[K,U,O,h]),J=(0,p.useSyncExternalStore)((0,p.useCallback)(()=>()=>{},[]),()=>CSS.supports("(view-transition-name: test)")),Y=(0,p.useMemo)(()=>[G?"background":"active",U?"reloading":"idle",J?"":w,H&&!K?"timedOut":""],[J,K,U,G,H,w]),[Q,Z]=(0,p.useState)(w),[ee,et]=(0,p.useState)(tU[w]);(0,p.useEffect)(()=>{if(J&&w!==Q){let e=()=>{Z(w),et(tU[w])};!T&&"startViewTransition"in document&&"function"==typeof document.startViewTransition?document.startViewTransition({update:()=>(0,F.flushSync)(()=>e()),types:["sanity-iframe-viewport"]}):e()}},[J,T,Q,w]);let er=(0,d.useToast)(),en=te(b),[ei,ea]=(0,p.useState)(!1),[eo]=(0,p.useState)(new Set),es=(0,g.useEffectEvent)(e=>{if(en.some(t=>t.test(e)))return void ea(e);eo.has(e)||(eo.add(e),console.warn("Visual Editing is here but misconfigured",{reportedOrigin:e}),er.push({closable:!0,id:"presentation-iframe-origin-mismatch-".concat(e),status:"error",duration:1/0,title:k("preview-frame.configuration.error.title"),description:(0,n.jsx)(m.Translate,{t:k,i18nKey:"preview-frame.configuration.error.description",components:{Code:"code"},values:{targetOrigin:_.origin,reportedOrigin:e}})}))}),el=(0,o.usePresentationNavigate)(),ec=(0,g.useEffectEvent)(e=>{if(!ei)return;let t=new URL(e,ei);el("".concat(ei).concat(t.pathname).concat(t.search).concat(t.hash))});return(0,p.useEffect)(()=>{var e;if(!ei)return;let t=null==(e=R.current)?void 0:e.contentWindow;if(!t)return;let r=(0,s.createController)({targetOrigin:ei});r.addTarget(t);let n=r.createChannel({name:"presentation",heartbeat:!0,connectTo:"visual-editing"},(0,s.createConnectionMachine)().provide({actors:(0,l.createCompatibilityActors)()}));n.on("visual-editing/navigate",e=>{ec(e.url)});let i=n.start();return()=>{i(),r.destroy()}},[ei]),(0,p.useEffect)(()=>{if("connecting"===h||"reconnecting"===h){let e=setInterval(()=>{var e,t;null==(t=R.current)||null==(e=t.contentWindow)||e.postMessage({domain:"sanity/channels",from:"presentation",type:"presentation/status"},"*")},1e3),t=new AbortController;return window.addEventListener("message",e=>{let{data:t}=e;t&&"object"==typeof t&&"domain"in t&&"sanity/channels"===t.domain&&"type"in t&&"visual-editing/status"===t.type&&"data"in t&&"object"==typeof t.data&&t.data&&"origin"in t.data&&"string"==typeof t.data.origin&&es(t.data.origin)},{signal:t.signal}),()=>{t.abort(),clearInterval(e)}}},[h,I]),(0,n.jsx)(N,{transition:T?{duration:0}:void 0,children:(0,n.jsxs)(E.TooltipDelayGroupProvider,{children:[A,(0,n.jsx)(u.Card,{flex:1,tone:"transparent",children:(0,n.jsxs)(u.Flex,{align:"center",height:"fill",justify:"center",padding:2*((J?Q:w)!=="desktop"),sizing:"border",style:{position:"relative",cursor:D?"wait":void 0},children:[(0,n.jsx)(L.AnimatePresence,{children:z||U||O||!H||K?!U&&("connecting"!==h||O)||K?z&&!K?(0,n.jsx)(tk,{initial:"initial",animate:"animate",exit:"exit",variants:tA,justify:"center",align:"center",style:{background:"var(--card-bg-color)",inset:"0",position:"absolute"},children:(0,n.jsx)(eA,{flex:1,message:k("preview-frame.connection.error.text"),onRetry:V,onContinueAnyway:W,children:C&&(0,n.jsxs)(n.Fragment,{children:["connected"!==h&&(0,n.jsx)(u.Card,{padding:3,radius:2,tone:"critical",children:(0,n.jsxs)(u.Stack,{space:3,children:[(0,n.jsx)(u.Label,{muted:!0,size:0,children:k("preview-frame.overlay.connection-status.label")}),(0,n.jsx)(u.Code,{size:1,children:k("channel.status",{context:h})})]})}),"connected"!==f&&(0,n.jsx)(u.Card,{padding:3,radius:2,tone:"critical",children:(0,n.jsxs)(u.Stack,{space:3,children:[(0,n.jsx)(u.Label,{muted:!0,size:0,children:k("preview-frame.loader.connection-status.label")}),(0,n.jsx)(u.Code,{size:1,children:k("channel.status",{context:f})})]})})]})})}):null:(0,n.jsx)(tk,{initial:"initial",animate:"animate",exit:"exit",variants:tR,justify:"center",align:"center",style:{inset:"0",position:"absolute"},children:(0,n.jsxs)(u.Flex,{style:{...tT[w]},justify:"center",align:"center",direction:"column",gap:4,children:[(0,n.jsx)(u.Spinner,{muted:!0}),(0,n.jsx)(u.Text,{muted:!0,size:1,children:k("preview-frame.status",{context:"loading"})})]})}):(0,n.jsx)(tk,{initial:"initial",animate:"animate",exit:"exit",variants:tR,justify:"center",align:"center",style:{inset:"0",position:"absolute",backdropFilter:I?"blur(16px) saturate(0.5) grayscale(0.5)":"blur(2px)",transition:"backdrop-filter 0.2s ease-in-out",WebkitBackdropFilter:I?"blur(16px) saturate(0.5) grayscale(0.5)":"blur(2px)",WebkitTransition:"-webkit-backdrop-filter 0.2s ease-in-out",zIndex:1},children:(0,n.jsxs)(u.Flex,{style:{...tT[w]},justify:"center",align:"center",direction:"column",gap:4,children:[I&&(0,n.jsx)(E.Button,{disabled:!0,mode:"ghost",text:k("preview-frame.continue-button.text"),style:{opacity:0}}),(0,n.jsx)(u.Card,{radius:2,tone:I?"caution":"inherit",padding:4,shadow:1,children:(0,n.jsxs)(u.Flex,{justify:"center",align:"center",direction:"column",gap:4,children:[(0,n.jsx)(u.Spinner,{muted:!0}),(0,n.jsx)(u.Text,{muted:!0,size:1,children:I?k("preview-frame.status",{context:"timeout"}):k("preview-frame.status",{context:"connecting"})})]})}),I&&(0,n.jsx)(E.Button,{tone:"critical",onClick:W,text:k("preview-frame.continue-button.text")})]})})}),(0,n.jsx)(ti,{animate:Y,initial:["background"],onLoad:X,preventClick:G,ref:R,src:_.toString(),style:ee,variants:tU})]})})]})})}));tC.displayName="Memo(ForwardRef(Preview))";let tT={desktop:{width:"100%",height:"100%"},mobile:{width:375,height:650}},tR={initial:{opacity:1},animate:{opacity:[0,0,1]},exit:{opacity:[1,0,0]}},tA={initial:{opacity:1},animate:{opacity:[0,0,1]},exit:{opacity:[1,0,0]}},tU={desktop:{...tT.desktop,boxShadow:"0 0 0 0px var(--card-border-color)"},mobile:{...tT.mobile,boxShadow:"0 0 0 1px var(--card-border-color)"},background:{opacity:0,scale:1},idle:{scale:1},reloading:{scale:[1,1,1,.98]},active:{opacity:[0,0,1],scale:1},timedOut:{opacity:[0,0,1]}},tI=function(){let e=!1;return function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];e||(console.warn(...r),e=!0)}}();function tL(e,t){return Object.values(t).forEach(t=>{e[t._id]=t}),e}function tM(e){return"_projectId"in e&&e._projectId?(tI("Cross dataset references are not supported yet, ignoring source document",e),!1):e}function tO(e,t){return e instanceof Function?e(t):e}function tz(e){let[t]=e;return"preview"===t}let tN=/^([\w-]+):(0|[1-9][0-9]*)$/,tF=/^([\w-]+):([0-9]+),([0-9]+)$/,tB=/^([\w-]+):([\w-]+)$/;function tD(e){return Object.fromEntries(Object.entries(e).filter(e=>{let[,t]=e;return void 0!==t&&""!==t&&null!==t}))}let tV=()=>e=>e,tW=tV()(["perspective","preview","viewport"]),tK=tV()(["changesInspectorTab","comment","inspect","instruction","parentRefPath","path","pathKey","rev","since","template","templateParams","version","view"]);function t$(){return new Set}function tH(e){return e()}function tq(){let{perspectiveStack:e,selectedPerspectiveName:t,selectedReleaseId:r}=(0,m.usePerspective)();return r?e:void 0===t?"drafts":t}function tX(){let e,t,r,n,a=(0,i.c)(4);a[0]===Symbol.for("react.memo_cache_sentinel")?(e=new Map,a[0]=e):e=a[0];let[o,s]=(0,p.useState)(e);e:{let e=Array.from(o.values());if(e.find(tY)){t="connected";break e}let r=e.filter(tJ);if(r.length){t=r.some(tG)?"connecting":"reconnecting";break e}t="idle"}let l=t;a[1]===Symbol.for("react.memo_cache_sentinel")?(r=e=>{s(t=>{let r=new Map(t);if("disconnected"===e.status)r.delete(e.connection);else{var n;let t=(null==(n=r.get(e.connection))?void 0:n.hasConnected)||"connected"===e.status,i="handshaking"===e.status?"connecting":e.status;r.set(e.connection,{status:i,hasConnected:t})}return r})},a[1]=r):r=a[1];let c=r;return a[2]!==l?(n=[l,c],a[2]=l,a[3]=n):n=a[3],n}function tG(e){let{hasConnected:t}=e;return!t}function tJ(e){let{status:t}=e;return"connecting"===t}function tY(e){let{status:t}=e;return"connected"===t}let tQ=(0,p.lazy)(()=>e.A(584998)),tZ=(0,p.lazy)(()=>e.A(243109)),t0=(0,p.lazy)(()=>e.A(235977)),t1=(0,p.lazy)(()=>e.A(110855)),t2=(0,p.lazy)(()=>e.A(167666)),t3=(0,p.lazy)(()=>e.A(631146)),t4=(0,p.lazy)(()=>e.A(183722)),t5=(0,v.styled)(u.Flex)(ec());function t6(e){var t,r,d;let{canToggleSharePreviewAccess:v,canUseSharedPreviewAccess:w,tool:y,vercelProtectionBypass:x,initialPreviewUrl:b,previewUrlRef:P}=e,S=te(P),j=tc(P),_=null==(t=y.options)?void 0:t.components,E=y.name||o.DEFAULT_TOOL_NAME,{unstable_navigator:k,unstable_header:C}=_||{},{navigate:T,state:R}=(0,h.useRouter)(),A=(0,m.useUnique)(Object.fromEntries(R._searchParams||[])),U=tq(),I=(0,a.useSelector)(P,e=>{var t;return(null==(t=e.context.previewMode)?void 0:t.shareAccess)!==!1}),[L]=(0,p.useState)(()=>{var e;let t=null==(e=y.options)?void 0:e.devMode;return"function"==typeof t?t():"boolean"==typeof t?t:"u">typeof window&&"localhost"===window.location.hostname}),M=(0,p.useRef)(null),[O,z]=(0,p.useState)(),[N,F]=(0,p.useState)(null),B=(0,p.useRef)({title:void 0,url:void 0}),{isSameDocument:D,navigate:V,navigationHistory:W,params:X,searchParams:G,structureParams:J}=function(e){let{initialPreviewUrl:t,routerNavigate:r,routerState:n,routerSearchParams:i,frameStateRef:a}=e,o=(0,p.useMemo)(()=>{let{id:e,path:r,type:a}={id:function(e){var t;if(void 0===e)return;let r=null==(t=decodeURIComponent(e))?void 0:t.split(".");return"drafts"===r[0]&&r.shift(),r.join(".")}(n.id),path:function(e){if(void 0!==e)return f.studioPath.toString(function(e){let t=[];for(let r of e.split(".")){let e=tN.exec(r);if(e){t.push(e[1],Number(e[2]));continue}let n=tF.exec(r);if(n){t.push(n[1],[Number(n[2]),Number(n[3])]);continue}let i=tB.exec(r);if(i){t.push(i[1],{_key:i[2]});continue}t.push(r)}return t}(decodeURIComponent(e)))}(n.path),type:n.type};return{id:e,type:a,path:r,preview:i.preview||t.toString(),perspective:i.perspective,viewport:i.viewport,inspect:i.inspect,parentRefPath:i.parentRefPath,rev:i.rev,since:i.since,template:i.template,templateParams:i.templateParams,view:i.view,pathKey:i.pathKey,instruction:i.instruction,comment:i.comment,changesInspectorTab:i.changesInspectorTab}},[n,i,t]),s=(0,p.useMemo)(()=>tD({inspect:o.inspect,path:o.path,parentRefPath:o.parentRefPath,rev:o.rev,since:o.since,template:o.template,templateParams:o.templateParams,view:o.view,pathKey:o.pathKey,instruction:o.instruction,comment:o.comment,changesInspectorTab:o.changesInspectorTab}),[o.changesInspectorTab,o.comment,o.inspect,o.instruction,o.path,o.pathKey,o.parentRefPath,o.rev,o.since,o.template,o.templateParams,o.view]),l=(0,p.useMemo)(()=>tD({perspective:o.perspective,preview:o.preview,viewport:o.viewport}),[o.perspective,o.preview,o.viewport]),c=(0,p.useRef)(n);(0,p.useLayoutEffect)(()=>{c.current=n},[n]);let[u,d]=(0,p.useState)([n]),m=(0,p.useCallback)(e=>{let{id:t,type:r}=e,{current:n}=c;return t===n.id&&r===n.type},[]),h=(0,p.useCallback)(e=>{let{state:t,params:n,replace:i=!1}=e;(null==t?void 0:t.id)&&(t.id=(0,f.getPublishedId)(t.id));let{current:a}=c,o={id:a.id,type:a.type,path:a.path},s=Object.fromEntries(a._searchParams||[]),l=t||o,u={...[...tW,...m(l)?tK:[]].reduce((e,t)=>(e[t]=s[t],e),{}),...n},p={...l,_searchParams:Object.entries(u).reduce((e,t)=>{let[r,n]=t;return[...e,[r,n]]},[])};d(e=>[...e,p]),r(p,{replace:i})},[m,r]);return{isSameDocument:m,navigate:h,navigationHistory:u,params:o,searchParams:l,structureParams:s}}({initialPreviewUrl:b,routerNavigate:T,routerState:R,routerSearchParams:A,frameStateRef:B}),Y=(0,a.useActorRef)(ep),Q=(0,p.useMemo)(()=>X.viewport?"mobile":"desktop",[X.viewport]),[Z,ee]=function(e,t){let r,n,a,o,s,l,c=(0,i.c)(11);(0,K.validateApiPerspective)(e),c[0]===Symbol.for("react.memo_cache_sentinel")?(r={},c[0]=r):r=c[0];let[u,d]=(0,p.useState)(r);c[1]===Symbol.for("react.memo_cache_sentinel")?(n={},c[1]=n):n=c[1];let[m,f]=(0,p.useState)(n),h=(0,p.useRef)("");c[2]!==t?(a=(e,r,n)=>{let i=(void 0===n?[]:n).filter(tM);("published"===r?d:f)(r=>{let n={};for(let e of i)n[e._id]=e;if(h.current!==t.current.url)return h.current=t.current.url,{[e]:n};let a=r[e];return(0,$.default)(a,n)?r:{...r,[e]:n}})},c[2]=t,c[3]=a):a=c[3];let v=a,g="published"===e?u:m;c[4]!==g?(o=Object.values(g).reduce(tL,{}),c[4]=g,c[5]=o):o=c[5];let w=o;c[6]!==w?(s=Object.values(w),c[6]=w,c[7]=s):s=c[7];let y=s;return c[8]!==y||c[9]!==v?(l=[y,v],c[8]=y,c[9]=v,c[10]=l):l=c[10],l}(U,B),et=(0,m.useProjectId)(),er=(0,m.useDataset)(),en=function(e){var t,r;let n,a,s,l,c,u,d=(0,i.c)(22),{navigate:f,navigationHistory:v,path:w,targetOrigin:y,resolvers:x}=e;d[0]!==x?(n=void 0===x?[]:x,d[0]=x,d[1]=n):n=d[1];let b=n,{state:P}=(0,h.useRouter)(),{perspectiveStack:S}=(0,m.usePerspective)();d[2]===Symbol.for("react.memo_cache_sentinel")?(a={apiVersion:o.API_VERSION},d[2]=a):a=d[2];let j=(0,m.useClient)(a);d[3]!==w||d[4]!==P?(s=w||(null==(r=P._searchParams)||null==(t=r.find(tz))?void 0:t[1])||"",d[3]=w,d[4]=P,d[5]=s):s=d[5];let _=s,[E,k]=(0,p.useState)(void 0),C=(0,p.useRef)(void 0);d[6]!==f||d[7]!==v?(l=(e,t)=>{var r,n;e&&C.current===e._id||(k({document:e,path:t.pathname}),C.current=null==e?void 0:e._id,(null==(r=v.at(-1))?void 0:r.id)===(null==(n=v.at(-2))?void 0:n.id)&&(null==f||f({state:{id:null==e?void 0:e._id,type:null==e?void 0:e._type}})))},d[6]=f,d[7]=v,d[8]=l):l=d[8];let T=(0,g.useEffectEvent)(l);return d[9]!==j||d[10]!==T||d[11]!==S||d[12]!==_||d[13]!==b||d[14]!==y?(c=()=>{let e=new URL(_,y);if(b.length){let o;for(let t of b){let r=function(e,t){for(e of Array.isArray(e)?e:[e]){let{origin:r}=t,n=e;if("string"==typeof e)try{let t=new URL(e);if(t.origin!==r)continue;r=t.origin,n=t.pathname}catch(e){}try{let e=(function(e,t){var r=[];return function(e,t,r){void 0===r&&(r={});var n=r.decode,i=void 0===n?function(e){return e}:n;return function(r){var n=e.exec(r);if(!n)return!1;for(var a=n[0],o=n.index,s=Object.create(null),l=1;l<n.length;l++)!function(e){if(void 0!==n[e]){var r=t[e-1];"*"===r.modifier||"+"===r.modifier?s[r.name]=n[e].split(r.prefix+r.suffix).map(function(e){return i(e,r)}):s[r.name]=i(n[e],r)}}(l);return{path:a,index:o,params:s}}}(function e(t,r,n){if(t instanceof RegExp){var i;if(!r)return t;for(var a=/\((?:\?<(.*?)>)?(?!\?)/g,o=0,s=a.exec(t.source);s;)r.push({name:s[1]||o++,prefix:"",suffix:"",modifier:"",pattern:""}),s=a.exec(t.source);return t}return Array.isArray(t)?(i=t.map(function(t){return e(t,r,n).source}),new RegExp("(?:".concat(i.join("|"),")"),q(n))):function(e,t,r){void 0===r&&(r={});for(var n=r.strict,i=void 0!==n&&n,a=r.start,o=r.end,s=r.encode,l=void 0===s?function(e){return e}:s,c=r.delimiter,u=r.endsWith,d="[".concat(H(void 0===u?"":u),"]|$"),p="[".concat(H(void 0===c?"/#?":c),"]"),m=void 0===a||a?"^":"",f=0;f<e.length;f++){var h=e[f];if("string"==typeof h)m+=H(l(h));else{var v=H(l(h.prefix)),g=H(l(h.suffix));if(h.pattern)if(t&&t.push(h),v||g)if("+"===h.modifier||"*"===h.modifier){var w="*"===h.modifier?"?":"";m+="(?:".concat(v,"((?:").concat(h.pattern,")(?:").concat(g).concat(v,"(?:").concat(h.pattern,"))*)").concat(g,")").concat(w)}else m+="(?:".concat(v,"(").concat(h.pattern,")").concat(g,")").concat(h.modifier);else{if("+"===h.modifier||"*"===h.modifier)throw TypeError('Can not repeat "'.concat(h.name,'" without a prefix and suffix'));m+="(".concat(h.pattern,")").concat(h.modifier)}else m+="(?:".concat(v).concat(g,")").concat(h.modifier)}}if(void 0===o||o)i||(m+="".concat(p,"?")),m+=r.endsWith?"(?=".concat(d,")"):"$";else{var y=e[e.length-1],x="string"==typeof y?p.indexOf(y[y.length-1])>-1:void 0===y;i||(m+="(?:".concat(p,"(?=").concat(d,"))?")),x||(m+="(?=".concat(p,"|").concat(d,")"))}return new RegExp(m,q(r))}(function(e,t){void 0===t&&(t={});for(var r=function(e){for(var t=[],r=0;r<e.length;){var n=e[r];if("*"===n||"+"===n||"?"===n){t.push({type:"MODIFIER",index:r,value:e[r++]});continue}if("\\"===n){t.push({type:"ESCAPED_CHAR",index:r++,value:e[r++]});continue}if("{"===n){t.push({type:"OPEN",index:r,value:e[r++]});continue}if("}"===n){t.push({type:"CLOSE",index:r,value:e[r++]});continue}if(":"===n){for(var i="",a=r+1;a<e.length;){var o=e.charCodeAt(a);if(o>=48&&o<=57||o>=65&&o<=90||o>=97&&o<=122||95===o){i+=e[a++];continue}break}if(!i)throw TypeError("Missing parameter name at ".concat(r));t.push({type:"NAME",index:r,value:i}),r=a;continue}if("("===n){var s=1,l="",a=r+1;if("?"===e[a])throw TypeError('Pattern cannot start with "?" at '.concat(a));for(;a<e.length;){if("\\"===e[a]){l+=e[a++]+e[a++];continue}if(")"===e[a]){if(0==--s){a++;break}}else if("("===e[a]&&(s++,"?"!==e[a+1]))throw TypeError("Capturing groups are not allowed at ".concat(a));l+=e[a++]}if(s)throw TypeError("Unbalanced pattern at ".concat(r));if(!l)throw TypeError("Missing pattern at ".concat(r));t.push({type:"PATTERN",index:r,value:l}),r=a;continue}t.push({type:"CHAR",index:r,value:e[r++]})}return t.push({type:"END",index:r,value:""}),t}(e),n=t.prefixes,i=void 0===n?"./":n,a=t.delimiter,o=void 0===a?"/#?":a,s=[],l=0,c=0,u="",d=function(e){if(c<r.length&&r[c].type===e)return r[c++].value},p=function(e){var t=d(e);if(void 0!==t)return t;var n=r[c],i=n.type,a=n.index;throw TypeError("Unexpected ".concat(i," at ").concat(a,", expected ").concat(e))},m=function(){for(var e,t="";e=d("CHAR")||d("ESCAPED_CHAR");)t+=e;return t},f=function(e){for(var t=0;t<o.length;t++){var r=o[t];if(e.indexOf(r)>-1)return!0}return!1},h=function(e){var t=s[s.length-1],r=e||(t&&"string"==typeof t?t:"");if(t&&!r)throw TypeError('Must have text between two parameters, missing text after "'.concat(t.name,'"'));return!r||f(r)?"[^".concat(H(o),"]+?"):"(?:(?!".concat(H(r),")[^").concat(H(o),"])+?")};c<r.length;){var v=d("CHAR"),g=d("NAME"),w=d("PATTERN");if(g||w){var y=v||"";-1===i.indexOf(y)&&(u+=y,y=""),u&&(s.push(u),u=""),s.push({name:g||l++,prefix:y,suffix:"",pattern:w||h(y),modifier:d("MODIFIER")||""});continue}var x=v||d("ESCAPED_CHAR");if(x){u+=x;continue}if(u&&(s.push(u),u=""),d("OPEN")){var y=m(),b=d("NAME")||"",P=d("PATTERN")||"",S=m();p("CLOSE"),s.push({name:b||(P?l++:""),pattern:b&&!P?h(y):P,prefix:y,suffix:S,modifier:d("MODIFIER")||""});continue}p("END")}return s}(t,n),r,n)}(e,r,t),r,t)})(n,{decode:decodeURIComponent})(t.pathname);if(e){let{params:t,path:n}=e;return{origin:r,params:t,path:n}}}catch(t){throw Error('"'.concat(e,'" is not a valid route pattern'))}}}(t.route,e);if(r){o={context:r,resolver:t};break}}if(o){var t,r,n,i,a;let s=function(e,t){if(e.resolve){var r;let n=null==(r=e.resolve(t))?void 0:r.filter;return n?"// groq\n*[".concat(n,"][0]{_id, _type}"):void 0}return"type"in e?'// groq\n*[_type == "'.concat(e.type,'"][0]{_id, _type}'):"// groq\n*[".concat(tO(e.filter,t),"][0]{_id, _type}")}(o.resolver,o.context),l=(t=o.resolver,r=o.context,t.resolve?null!=(i=null==(n=t.resolve(r))?void 0:n.params)?i:r.params:"type"in t?{}:null!=(a=tO(t.params,r))?a:r.params);if(s){let t=new AbortController,r={perspective:S,signal:t.signal,tag:"use-main-document"};return j.fetch(s,l,r).then(t=>T(t,e)).catch(t=>{t instanceof Error&&"AbortError"===t.name||(k({document:void 0,path:e.pathname}),C.current=void 0)}),()=>{t.abort()}}}}k(void 0),C.current=void 0},d[9]=j,d[10]=T,d[11]=S,d[12]=_,d[13]=b,d[14]=y,d[15]=c):c=d[15],d[16]!==j||d[17]!==S||d[18]!==_||d[19]!==b||d[20]!==y?(u=[j,S,_,b,y],d[16]=j,d[17]=S,d[18]=_,d[19]=b,d[20]=y,d[21]=u):u=d[21],(0,p.useEffect)(c,u),E}({navigate:V,navigationHistory:W,path:X.preview,targetOrigin:j,resolvers:null==(d=y.options)||null==(r=d.resolve)?void 0:r.mainDocuments}),[ei,ea]=tX(),[eo,es]=tX(),[el,ec]=tX(),{open:ed}=(e=>{let t,r,n,a,s,l,c=(0,i.c)(10),[u,d]=(0,p.useState)(t$);c[0]===Symbol.for("react.memo_cache_sentinel")?(t=e=>{let t=window.open(e,"_blank");t&&d(e=>new Set(e).add(t))},c[0]=t):t=c[0];let m=t;return c[1]!==e||c[2]!==u?(r=()=>{let t=[];if(u.size&&e)for(let r of u)r&&"closed"in r&&!r.closed&&t.push(e.addTarget(r));return()=>{t.forEach(tH)}},n=[e,u],c[1]=e,c[2]=u,c[3]=r,c[4]=n):(r=c[3],n=c[4]),(0,p.useEffect)(r,n),c[5]!==u?(a=()=>{if(u.size){let e=setInterval(()=>{let e=new Set;for(let t of u)t&&"closed"in t&&t.closed&&e.add(t);e.size&&d(t=>{let r=new Set(t);for(let t of e)r.delete(t);return r})},o.POPUP_CHECK_INTERVAL);return()=>{clearInterval(e)}}},s=[u],c[5]=u,c[6]=a,c[7]=s):(a=c[6],s=c[7]),(0,p.useEffect)(a,s),c[8]!==u?(l={popups:u,open:m},c[8]=u,c[9]=l):l=c[9],l})(O),ef=(0,a.useSelector)(Y,e=>e.matches("loading"));(0,p.useEffect)(()=>{var e;let t=null==(e=M.current)?void 0:e.contentWindow;if(!t||ef)return;let r=(0,s.createController)({targetOrigin:j});return r.addTarget(t),z(r),()=>{r.destroy(),z(void 0)}},[j,ef]);let eg=(0,g.useEffectEvent)(e=>{V(e)});(0,p.useEffect)(()=>{if(!O)return;let e=O.createChannel({name:"presentation",heartbeat:!0,connectTo:"visual-editing"},(0,s.createConnectionMachine)().provide({actors:(0,l.createCompatibilityActors)()}));e.on("visual-editing/focus",e=>{"id"in e&&eg({state:{type:e.type,id:e.id,path:e.path}})}),e.on("visual-editing/navigate",e=>{let{title:t}=e,r=e.url;if(!r.startsWith("http"))try{r=new URL(r,j).toString()}catch(e){}if(B.current.url!==r)try{let[e,t]=r.split("?"),n=new URLSearchParams(t);n.delete(c.urlSearchParamVercelProtectionBypass),n.delete(c.urlSearchParamVercelSetBypassCookie),eg({params:{preview:"".concat(e).concat(n.size>0?"?":"").concat(n)}})}catch(e){eg({params:{preview:r}})}B.current={title:t,url:r}}),e.on("visual-editing/meta",e=>{B.current.title=e.title}),e.on("visual-editing/toggle",e=>{Y.send({type:"toggle visual editing overlays",enabled:e.enabled})}),e.on("visual-editing/documents",e=>{ee("visual-editing",e.perspective,e.documents)}),e.on("visual-editing/refreshing",e=>{"manual"===e.source?clearTimeout(eA.current):"mutation"===e.source&&Y.send({type:"iframe refresh"})}),e.on("visual-editing/refreshed",()=>{Y.send({type:"iframe loaded"})}),e.onStatus(ea);let t=e.start();return F(e),()=>{t(),F(null)}},[O,Y,ee,ea,j]),(0,p.useEffect)(()=>{if(!O)return;let e=O.createChannel({name:"presentation",connectTo:"preview-kit",heartbeat:!0},(0,s.createConnectionMachine)().provide({actors:(0,l.createCompatibilityActors)()}));return e.onStatus(ec),e.on("preview-kit/documents",e=>{e.projectId===et&&e.dataset===er&&ee("preview-kit",e.perspective,e.documents)}),e.start()},[O,er,et,ee,ec,j]);let ew=(0,p.useMemo)(()=>ev(e=>{D(e)&&V({state:e,replace:!0})},0),[D,V]),ey=(0,p.useCallback)(e=>{let t=new URL(e,j),r=t.toString();X.preview!==r&&(Array.isArray(S)?S.some(e=>e.test(r))&&V({params:{preview:r}}):t.origin===j&&V({params:{preview:r}}))},[j,X.preview,S,V]),ex=(0,p.useCallback)(e=>{V({params:e})},[V]),eb=(0,p.useCallback)(e=>{V(e)},[V]);(0,p.useEffect)(()=>{X.id&&X.path?null==N||N.post("presentation/focus",{id:X.id,path:X.path}):null==N||N.post("presentation/blur")},[X.id,X.path,N]),(0,p.useEffect)(()=>{if(B.current.url&&X.preview&&B.current.url!==X.preview){try{let e=new URL(B.current.url,j).origin,t=new URL(X.preview,j).origin;if(e!==t)return}catch(e){}if(B.current.url=X.preview,"connected"===ei){let e=X.preview;if(e.startsWith("http"))try{let t=new URL(X.preview,j);e=t.pathname+t.search+t.hash}catch(e){}null==N||N.post("presentation/navigate",{url:e,type:"replace"})}}},[ei,j,X.preview,N]);let eP=(0,p.useCallback)(()=>null==N?void 0:N.post("presentation/toggle-overlay"),[N]),[eS,ej]=(0,p.useState)(null);(0,p.useEffect)(()=>{let e=e=>{t7(e)&&eP()},t=e=>{var t,r;t7(e)&&eP(),t=["mod","\\"],r=e,t.every(e=>t8[e]?r[t8[e]]:r.key===e.toUpperCase())&&eP()};return window.addEventListener("keydown",t),window.addEventListener("keyup",e),()=>{window.removeEventListener("keydown",t),window.removeEventListener("keyup",e)}},[eP]);let[e_,eE]=(0,p.useState)(null),[{navigatorEnabled:ek,toggleNavigator:eC},eT]=function(e){let t,r,a,o,s=(0,i.c)(11),{unstable_navigator:l}=e,c=!!(null==l?void 0:l.component),[u,d]=function(e,t){let r,n,a,o,s=(0,i.c)(9);s[0]!==t||s[1]!==e?(r=()=>{var r;return JSON.parse(null!=(r=localStorage.getItem(e))?r:JSON.stringify(t))},s[0]=t,s[1]=e,s[2]=r):r=s[2];let[l,c]=(0,p.useState)(r);return s[3]!==e||s[4]!==l?(n=()=>{localStorage.setItem(e,JSON.stringify(l))},a=[e,l],s[3]=e,s[4]=l,s[5]=n,s[6]=a):(n=s[5],a=s[6]),(0,p.useEffect)(n,a),s[7]!==l?(o=[l,c],s[7]=l,s[8]=o):o=s[8],o}("presentation/navigator",c),m=!!c&&u;e:{let e;if(!c){t=void 0;break e}s[0]!==d?(e=()=>d(e6),s[0]=d,s[1]=e):e=s[1],t=e}let f=t;s[2]!==m||s[3]!==l?(r=function(){return(0,n.jsx)(n.Fragment,{children:m&&(0,n.jsx)(e7,{...l})})},s[2]=m,s[3]=l,s[4]=r):r=s[4];let h=r;return s[5]!==m||s[6]!==f?(a={navigatorEnabled:m,toggleNavigator:f},s[5]=m,s[6]=f,s[7]=a):a=s[7],s[8]!==h||s[9]!==a?(o=[a,h],s[8]=h,s[9]=a,s[10]=o):o=s[10],o}({unstable_navigator:k}),eA=(0,p.useRef)(void 0),eU=(0,p.useCallback)(e=>{if(Y.send({type:"iframe refresh"}),N){eA.current=window.setTimeout(e,300),N.post("presentation/refresh",{source:"manual",livePreviewEnabled:"connected"===el||"connected"===eo});return}e()},[eo,Y,el,N]),eI=(0,m.useWorkspace)(),eL=(0,p.useCallback)(e=>{let{id:t,type:r,path:n}=e;if(B.current.url)return{title:B.current.title||B.current.url,name:"edit",params:{id:t,path:n,type:r,inspect:m.COMMENTS_INSPECTOR_NAME,workspace:eI.name,mode:o.EDIT_INTENT_MODE,preview:X.preview}}},[X.preview,eI.name]),eM=(0,p.useCallback)(e=>{V({params:{viewport:"desktop"===e?void 0:"mobile"},replace:!0})},[V]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e9,{devMode:L,name:E,navigate:V,params:X,searchParams:G,structureParams:J,children:(0,n.jsx)(e5,{navigate:V,children:(0,n.jsx)(e8,{params:X,children:(0,n.jsx)(em,{comlink:N,children:(0,n.jsx)(t5,{"data-testid":"presentation-root",height:"fill",children:(0,n.jsxs)(eR,{children:[(0,n.jsx)(eT,{}),(0,n.jsx)(eh,{id:"preview",minWidth:325,defaultSize:ek?50:75,order:3,children:(0,n.jsx)(u.Flex,{direction:"column",flex:1,height:"fill",ref:eE,children:(0,n.jsx)(u.BoundaryElementProvider,{element:e_,children:(0,n.jsx)(tC,{canSharePreviewAccess:I,canToggleSharePreviewAccess:v,canUseSharedPreviewAccess:w,header:C,initialUrl:b,loadersConnection:eo,navigatorEnabled:ek,onPathChange:ey,onRefresh:eU,openPopup:ed,overlaysConnection:ei,previewUrl:X.preview,perspective:U,ref:M,setViewport:eM,targetOrigin:j,toggleNavigator:eC,toggleOverlay:eP,viewport:Q,vercelProtectionBypass:x,presentationRef:Y,previewUrlRef:P},j)})})}),(0,n.jsx)(e4,{documentId:X.id,documentsOnPage:Z,documentType:X.type,getCommentIntent:eL,mainDocumentState:en,onEditReference:eb,onFocusPath:ew,onStructureParams:ex,searchParams:G,setDisplayedDocument:ej,structureParams:J})]})})})})})}),(0,n.jsxs)(p.Suspense,{children:[O&&(0,n.jsx)(tQ,{controller:O,perspective:U,liveDocument:eS,onDocumentsOnPage:ee,onLoadersConnection:es}),N&&X.id&&X.type&&(0,n.jsx)(t0,{comlink:N,id:X.id,type:X.type,loadersConnection:eo,previewKitConnection:el}),N&&(0,n.jsx)(t3,{comlink:N,perspective:U}),N&&Z.length>0&&(0,n.jsx)(t2,{comlink:N,perspective:U,refs:Z}),N&&(0,n.jsx)(tZ,{comlink:N,perspective:U}),N&&(0,n.jsx)(eu,{comlink:N}),N&&(0,n.jsx)(t1,{comlink:N,perspective:U}),N&&(0,n.jsx)(t4,{comlink:N})]})]})}function t7(e){return"Alt"===e.key}let t8={alt:"altKey",ctrl:"ctrlKey",mod:"u">typeof window&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform)?"metaKey":"ctrlKey",shift:"shiftKey"},t9=(0,x.fromPromise)(async e=>{let{input:t}=e,{previewSearchParam:r,initialUrl:n,allowOrigins:i}=t;if(!r)return n;try{let e=new URL(r,n.origin);return i.some(t=>t.test(e.origin))?e:n}catch(e){return n}}),re={_id:c.schemaIdSingleton,_type:c.schemaTypeSingleton},rt={_id:"drafts.".concat((0,X.uuid)()),_type:c.schemaType},rr=(0,w.setup)({types:{},actions:{"notify preview will likely fail":(0,b.l)("Missing permissions to create preview secret, or read shared preview secret. Preview will likely fail loading."),"assign preview search param":(0,y.assign)({previewSearchParam:(e,t)=>t.previewSearchParam}),"assign error":(0,y.assign)({error:(e,t)=>t.error instanceof Error?t.error:Error(t.message,{cause:t.error})})},actors:{"check permission":(0,x.fromObservable)(()=>(0,J.throwError)(()=>Error("The 'check permission' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'check permission': fromObservable(({input}: {input: CheckPermissionInput}) => ...)}})"))),"resolve initial url":(0,x.fromPromise)(()=>Promise.reject(Error("The 'resolve initial url' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'resolve initial url': fromPromise(...)}})"))),"resolve allow patterns":(0,x.fromPromise)(()=>Promise.reject(Error("The 'resolve allow patterns' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'resolve allow pattern': fromPromise(...)}})"))),"resolve url from preview search param":t9,"resolve preview mode":(0,x.fromPromise)(()=>Promise.reject(Error("The 'resolve preview mode' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'resolve preview mode': fromPromise(...)}})"))),"create preview secret":(0,x.fromPromise)(async()=>Promise.reject(Error("The 'create preview secret' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'create preview secret': fromPromise(...)}})"))),"read shared preview secret":(0,x.fromPromise)(async()=>Promise.reject(Error("The 'read shared preview secret' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'read shared preview secret': fromPromise(...)}})"))),"resolve preview mode url":(0,x.fromPromise)(()=>Promise.reject(Error("The 'resolve preview mode url' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'resolve preview mode url': fromPromise(...)}})")))},guards:{"has checked permissions":e=>{let{context:t}=e;return!!(t.previewAccessSharingCreatePermission&&t.previewAccessSharingReadPermission&&t.previewAccessSharingUpdatePermission&&t.previewUrlSecretPermission)},"search param has new origin":e=>{let{context:t,event:r}=e;if(!t.previewUrl||!r.previewSearchParam)return!1;try{let e=new URL(r.previewSearchParam,t.previewUrl);return t.previewUrl.origin!==e.origin}catch(e){return!1}},"can create preview secret":e=>{var t;let{context:r}=e;return(null==(t=r.previewUrlSecretPermission)?void 0:t.granted)===!0},"has preview mode with created secret":(e,t)=>{var r;let{context:n}=e;return!1!==t&&(null==(r=n.previewUrlSecretPermission)?void 0:r.granted)===!0},"has preview mode with share access":(e,t)=>{var r;let{context:n}=e;return!1!==t&&(null==(r=n.previewAccessSharingReadPermission)?void 0:r.granted)===!0},"has preview mode without permissions":(e,t)=>{var r,n;let{context:i}=e;return!1!==t&&(null==(r=i.previewAccessSharingReadPermission)?void 0:r.granted)===!1&&(null==(n=i.previewUrlSecretPermission)?void 0:n.granted)===!1}},delays:{expiredSecret:e=>{var t;let{context:r}=e;if(!(null==(t=r.previewUrlSecret)?void 0:t.expiresAt))return 0;let n=Date.now();return Math.max(r.previewUrlSecret.expiresAt.getTime()-n,0)}}}).createMachine({id:"Preview URL",context:e=>{let{input:t}=e;return{initialUrl:null,previewUrl:null,error:null,allowOrigins:null,previewSearchParam:t.previewSearchParam,previewUrlSecret:null,previewAccessSharingCreatePermission:null,previewAccessSharingReadPermission:null,previewAccessSharingUpdatePermission:null,previewUrlSecretPermission:null,previewMode:null}},invoke:[{src:"check permission",input:()=>({checkPermissionName:"read",document:re}),onError:{target:".error",actions:{type:"assign error",params:e=>{let{event:t}=e;return{message:"Failed to check permission",error:t.error}}}},onSnapshot:{actions:(0,y.assign)({previewAccessSharingReadPermission:e=>{var t;let{event:r}=e;return null!=(t=r.snapshot.context)?t:null}})}},{src:"check permission",input:()=>({checkPermissionName:"create",document:re}),onError:{target:".error",actions:{type:"assign error",params:e=>{let{event:t}=e;return{message:"Failed to check permission",error:t.error}}}},onSnapshot:{actions:(0,y.assign)({previewAccessSharingCreatePermission:e=>{var t;let{event:r}=e;return null!=(t=r.snapshot.context)?t:null}})}},{src:"check permission",input:()=>({checkPermissionName:"update",document:re}),onError:{target:".error",actions:{type:"assign error",params:e=>{let{event:t}=e;return{message:"Failed to check permission",error:t.error}}}},onSnapshot:{actions:(0,y.assign)({previewAccessSharingUpdatePermission:e=>{var t;let{event:r}=e;return null!=(t=r.snapshot.context)?t:null}})}},{src:"check permission",input:()=>({checkPermissionName:"create",document:rt}),onError:{target:".error",actions:{type:"assign error",params:e=>{let{event:t}=e;return{message:"Failed to check permission",error:t.error}}}},onSnapshot:{actions:(0,y.assign)({previewUrlSecretPermission:e=>{var t;let{event:r}=e;return null!=(t=r.snapshot.context)?t:null}})}}],on:{"set preview search param":{actions:{type:"assign preview search param",params:e=>{let{event:t}=e;return{previewSearchParam:t.previewSearchParam}}}}},states:{checkingPermissions:{always:{guard:"has checked permissions",target:"resolvingInitialUrl"},tags:"busy"},resolvingInitialUrl:{invoke:{src:"resolve initial url",input:e=>{let{context:t}=e;return{previewSearchParam:t.previewSearchParam}},onError:{target:"error",actions:{type:"assign error",params:e=>{let{event:t}=e;return{message:"Failed to resolve initial url",error:t.error}}}},onDone:{target:"resolvingAllowPatterns",actions:(0,y.assign)({initialUrl:e=>{let{event:t}=e;return t.output}})}},tags:"busy"},error:{type:"final",tags:"error"},resolvingAllowPatterns:{invoke:{src:"resolve allow patterns",input:e=>{let{context:t}=e;return{initialUrl:t.initialUrl}},onError:{target:"error",actions:{type:"assign error",params:e=>{let{event:t}=e;return{message:"Failed to resolve preview url allow patterns",error:t.error}}}},onDone:{target:"resolvingUrlFromPreviewSearchParam",actions:(0,y.assign)({allowOrigins:e=>{let{event:t}=e;return t.output}})}},tags:["busy"]},resolvingUrlFromPreviewSearchParam:{id:"loop",invoke:{src:"resolve url from preview search param",input:e=>{let{context:t}=e;return{initialUrl:t.initialUrl,allowOrigins:t.allowOrigins,previewSearchParam:t.previewSearchParam}},onError:{target:"error",actions:{type:"assign error",params:e=>{let{event:t}=e;return{message:"Failed to resolve preview url from search param",error:t.error}}}},onDone:{target:"resolvingPreviewMode",actions:(0,y.assign)({initialUrl:e=>{let{event:t}=e;return t.output}})}},tags:["busy"]},resolvingPreviewMode:{on:{"set preview search param":{guard:"search param has new origin",actions:{type:"assign preview search param",params:e=>{let{event:t}=e;return{previewSearchParam:t.previewSearchParam}}},target:"#loop",reenter:!0}},invoke:{src:"resolve preview mode",input:e=>{let{context:t}=e;return{targetOrigin:t.initialUrl.origin}},onError:{target:"error",actions:{type:"assign error",params:e=>{let{event:t}=e;return{message:"Failed to resolve preview url allow patterns",error:t.error}}}},onDone:[{guard:{type:"has preview mode with created secret",params:e=>{let{event:t}=e;return t.output}},actions:(0,y.assign)({previewMode:e=>{let{event:t}=e;return t.output}}),target:"previewMode.createPreviewSecret"},{guard:{type:"has preview mode with share access",params:e=>{let{event:t}=e;return t.output}},actions:(0,y.assign)({previewMode:e=>{let{event:t}=e;return t.output}}),target:"previewMode.readShareAccess"},{guard:{type:"has preview mode without permissions",params:e=>{let{event:t}=e;return t.output}},actions:[(0,y.assign)({previewUrl:e=>{let{context:t}=e;return t.initialUrl}}),"notify preview will likely fail"],target:"success"},{actions:(0,y.assign)({previewUrl:e=>{let{context:t}=e;return t.initialUrl}}),target:"success"}]},tags:["busy"]},success:{on:{"set preview search param":{guard:"search param has new origin",actions:{type:"assign preview search param",params:e=>{let{event:t}=e;return{previewSearchParam:t.previewSearchParam}}},target:"#loop",reenter:!0}}},previewMode:{on:{"set preview search param":{guard:"search param has new origin",actions:{type:"assign preview search param",params:e=>{let{event:t}=e;return{previewSearchParam:t.previewSearchParam}}},target:"#loop",reenter:!0}},states:{createPreviewSecret:{invoke:{src:"create preview secret",onError:{target:"error",actions:{type:"assign error",params:e=>{let{event:t}=e;return{message:"Failed to create preview secret",error:t.error}}}},onDone:{target:"resolvePreviewUrl",actions:(0,y.assign)({previewUrlSecret:e=>{let{event:t}=e;return t.output}})}},tags:["busy"]},readShareAccess:{invoke:{src:"read shared preview secret",onError:{target:"error",actions:{type:"assign error",params:e=>{let{event:t}=e;return{message:"Failed to read shared preview secret",error:t.error}}}},onDone:{target:"resolvePreviewUrl",actions:(0,y.assign)({previewUrlSecret:e=>{let{event:t}=e;return{secret:t.output,expiresAt:new Date(Date.now()+5184e6)}}})}},tags:["busy"]},resolvePreviewUrl:{invoke:{src:"resolve preview mode url",input:e=>{let{context:t}=e;return{initialUrl:t.initialUrl,resolvedPreviewMode:t.previewMode,previewUrlSecret:t.previewUrlSecret.secret}},onError:{target:"error",actions:{type:"assign error",params:e=>{let{event:t}=e;return{message:"Failed to resolve preview url",error:t.error}}}},onDone:{target:"success",actions:(0,y.assign)({previewUrl:e=>{let{event:t}=e;return t.output}})}},tags:["busy"]},error:{type:"final",tags:["error"]},success:{after:{expiredSecret:{guard:"can create preview secret",actions:(0,y.assign)({previewUrlSecret:null}),target:"createPreviewSecret",reenter:!0}}}},initial:"readShareAccess"}},initial:"checkingPermissions"});function rn(e){return"error"===e.status?e.error:e.hasTag("error")?e.context.error:null}function ri(e){var t;return null==(t=e.context.previewUrl)?void 0:t.origin}function ra(e){return e.context.allowOrigins}function ro(){return"ready"}function rs(t){var r,s;let l,u=(0,i.c)(8),{tool:f}=t,v=function(t,r){var n,s,l;let u,f,v,g,w,y,b=(0,i.c)(24),P=(0,m.useGrantsStore)();b[0]===Symbol.for("react.memo_cache_sentinel")?(u={apiVersion:o.API_VERSION},b[0]=u):u=b[0];let S=(0,m.useClient)(u),j=null==(n=(0,m.useCurrentUser)())?void 0:n.id,_=(null==(l=(0,m.useActiveWorkspace)())||null==(s=l.activeWorkspace)?void 0:s.basePath)||"/",E=(0,h.useRouter)();b[1]!==E.state._searchParams?(f=new URLSearchParams(E.state._searchParams).get("preview"),b[1]=E.state._searchParams,b[2]=f):f=b[2];let k=f,{push:C}=(0,d.useToast)(),{t:T}=(0,m.useTranslation)(o.presentationLocaleNamespace),R=tq();if(b[3]!==r||b[4]!==S||b[5]!==j||b[6]!==P||b[7]!==R||b[8]!==t||b[9]!==C||b[10]!==_||b[11]!==T){let n,i;b[13]!==C||b[14]!==T?(n=()=>C({id:"preview-url-secret.missing-grants",closable:!0,status:"error",duration:1/0,title:T("preview-url-secret.missing-grants")}),b[13]=C,b[14]=T,b[15]=n):n=b[15],b[16]!==P?(i=e=>{let{input:t}=e;return P.checkDocumentPermission(t.checkPermissionName,t.document)},b[16]=P,b[17]=i):i=b[17],v=rr.provide({actions:{"notify preview will likely fail":n},actors:{"create preview secret":function(e){let{client:t,currentUserId:r}=e;return(0,x.fromPromise)(async()=>await G(t,"sanity/presentation",location.href,r))}({client:S,currentUserId:j}),"read shared preview secret":function(e){let{client:t}=e;return(0,x.fromPromise)(async()=>t.fetch(c.fetchSharedAccessQuery,{},{tag:"presentation.fallback-to-shared-access-secret"}))}({client:S}),"resolve allow patterns":function(t){let{client:r,allowOption:n}=t;return(0,x.fromPromise)(async t=>{let{input:i}=t,{initialUrl:a}=i;if(typeof URLPattern>"u"&&await e.A(238551),!n)return[new URLPattern(a.origin)];let o="function"==typeof n?await n({client:r,origin,initialUrl:a}):n,s=(Array.isArray(o)?o:[o]).map(e=>{let t=new URLPattern(e);if("*"===t.hostname)throw Error("It's insecure to allow any hostname, it could disclose data to a malicious site");return t});return s.some(e=>e.test(a.origin))?s:[...s,new URLPattern(a.origin)]})}({client:S,allowOption:r}),"resolve initial url":function(e){let{client:t,studioBasePath:r,previewUrlOption:n,perspective:i}=e;return(0,x.fromPromise)(async e=>{let{input:a}=e,{origin:o}=location;return"function"==typeof n?new URL(await n({client:t,studioBasePath:r,previewUrlSecret:"",studioPreviewPerspective:tr(i),previewSearchParam:a.previewSearchParam}),o):n?"string"==typeof n?new URL(n,o):"function"==typeof n.initial?new URL(await n.initial({client:t,origin:o}),o):"string"==typeof n.initial?new URL(n.initial,o):new URL(n.preview||"/",n.origin||o):new URL("/",o)})}({client:S,studioBasePath:_,previewUrlOption:t,perspective:R}),"resolve preview mode":function(e){let{client:t,previewUrlOption:r}=e;return(0,x.fromPromise)(async e=>{var n,i;let{input:a}=e,{targetOrigin:o}=a;if("object"==typeof r&&(null==r?void 0:r.draftMode))return{enable:r.draftMode.enable,shareAccess:null==(n=r.draftMode.shareAccess)||n};if(!r||"string"==typeof r||"function"==typeof r||!r.previewMode)return!1;let s="function"==typeof r.previewMode?await r.previewMode({client:t,origin,targetOrigin:o}):r.previewMode;return!1!==s&&{enable:s.enable,shareAccess:null==(i=s.shareAccess)||i}})}({client:S,previewUrlOption:t}),"resolve preview mode url":function(e){let{client:t,studioBasePath:r,previewUrlOption:n,perspective:i}=e;return(0,x.fromPromise)(async e=>{let{input:a}=e,{previewUrlSecret:o,resolvedPreviewMode:s,initialUrl:l}=a;if("function"==typeof n)return new URL(await n({client:t,studioBasePath:r,previewUrlSecret:o,studioPreviewPerspective:tr(i),previewSearchParam:l.toString()}),l);if(!s)throw Error("Resolved preview mode is false");let u=new URL(s.enable,l);return u.searchParams.set(c.urlSearchParamPreviewSecret,o),u.searchParams.set(c.urlSearchParamPreviewPerspective,tr(i)),l.pathname!==u.pathname&&u.searchParams.set(c.urlSearchParamPreviewPathname,"".concat(l.pathname).concat(l.search).concat(l.hash)),u})}({client:S,studioBasePath:_,previewUrlOption:t,perspective:R}),"check permission":(0,x.fromObservable)(i)}}),b[3]=r,b[4]=S,b[5]=j,b[6]=P,b[7]=R,b[8]=t,b[9]=C,b[10]=_,b[11]=T,b[12]=v}else v=b[12];b[18]!==k?(g={input:{previewSearchParam:k}},b[18]=k,b[19]=g):g=b[19];let A=(0,a.useActorRef)(v,g);b[20]!==A||b[21]!==k?(w=()=>{A.send({type:"set preview search param",previewSearchParam:k})},y=[A,k],b[20]=A,b[21]=k,b[22]=w,b[23]=y):(w=b[22],y=b[23]),(0,p.useEffect)(w,y);let U=(0,a.useSelector)(A,rn);if(U)throw U;return A}(null==(r=f.options)?void 0:r.previewUrl,null==(s=f.options)?void 0:s.allowOrigins);!function(e){let t,r,s,l=(0,i.c)(9),{t:c}=(0,m.useTranslation)(o.presentationLocaleNamespace),{push:u}=(0,d.useToast)(),f=(0,h.useRouter)();l[0]!==f.state._searchParams?(t=new URLSearchParams(f.state._searchParams).get("preview"),l[0]=f.state._searchParams,l[1]=t):t=l[1];let v=t,g=(0,a.useSelector)(e,ra),w=(0,a.useSelector)(e,ri);l[2]!==g||l[3]!==w||l[4]!==v||l[5]!==u||l[6]!==c?(r=()=>{if(!Array.isArray(g)||!v||!w)return;let e=new URL(v,w).origin;g.some(t=>t.test(e))||u({closable:!0,id:"presentation-iframe-origin-mismatch-".concat(e),status:"error",duration:1/0,title:c("preview-search-param.configuration.error.title"),description:(0,n.jsx)(m.Translate,{t:c,i18nKey:"preview-search-param.configuration.error.description",components:{Code:"code"},values:{previewSearchParam:v,blockedOrigin:e}})})},s=[g,w,v,u,c],l[2]=g,l[3]=w,l[4]=v,l[5]=u,l[6]=c,l[7]=r,l[8]=s):(r=l[7],s=l[8]),(0,p.useEffect)(r,s)}(v);let g=(0,a.useSelector)(v,rp),w=(0,a.useSelector)(v,rd),y=(0,a.useSelector)(v,ru),b=(0,a.useSelector)(v,rc),P=(0,a.useSelector)(v,rl),[S,j]=function(){let e,t,r,n,a=(0,i.c)(7);a[0]===Symbol.for("react.memo_cache_sentinel")?(e={apiVersion:o.API_VERSION},a[0]=e):e=a[0];let s=(0,m.useClient)(e),[l,u]=(0,p.useReducer)(ro,"loading"),[d,f]=(0,p.useState)(null);return a[1]!==s?(t=()=>{let e=function(e,t){let r=new AbortController,n=[];async function i(r,i){let{result:a,syncTags:o}=await e.fetch(c.fetchVercelProtectionBypassSecret,{},{filterResponse:!1,lastLiveEventId:r,tag:"preview-url-secret.fetch-vercel-bypass-protection-secret"});Array.isArray(o)&&(n=o),i.aborted||t(a)}let a=e.live.events().subscribe({next:e=>{"message"===e.type&&(r.abort(),r=new AbortController,e.tags.some(e=>n.includes(e))&&i(e.id,r.signal))},error:e=>console.error(e)});return i(null,r.signal),()=>{a.unsubscribe(),r.abort()}}(s,e=>{f(e),u()});return()=>e()},r=[s],a[1]=s,a[2]=t,a[3]=r):(t=a[2],r=a[3]),(0,p.useEffect)(t,r),a[4]!==l||a[5]!==d?(n=[d,l],a[4]=l,a[5]=d,a[6]=n):n=a[6],n}();if(!P||"loading"===j||!g||typeof g.granted>"u"||!w||typeof w.granted>"u"||!b||!y||typeof y.granted>"u"||typeof b.granted>"u"){let e;return u[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,n.jsx)(o.PresentationSpinner,{}),u[0]=e):e=u[0],e}let _=(null==g?void 0:g.granted)===!0&&(null==w?void 0:w.granted)===!0,E=(null==y?void 0:y.granted)===!0;return u[1]!==v||u[2]!==_||u[3]!==E||u[4]!==f||u[5]!==P||u[6]!==S?(l=(0,n.jsx)(t6,{tool:f,initialPreviewUrl:P,vercelProtectionBypass:S,canToggleSharePreviewAccess:_,canUseSharedPreviewAccess:E,previewUrlRef:v}),u[1]=v,u[2]=_,u[3]=E,u[4]=f,u[5]=P,u[6]=S,u[7]=l):l=u[7],l}function rl(e){return e.context.previewUrl}function rc(e){return e.context.previewUrlSecretPermission}function ru(e){return e.context.previewAccessSharingReadPermission}function rd(e){return e.context.previewAccessSharingUpdatePermission}function rp(e){return e.context.previewAccessSharingCreatePermission}}]);