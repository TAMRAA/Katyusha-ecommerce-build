(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,949084,e=>{"use strict";e.s(["default",()=>j]);var t=e.i(881933),n=e.i(725917),i=e.i(271645),r=e.i(537152),o=e.i(216024),l=e.i(926005),a=e.i(843476),p=e.i(68428),u=e.i(997053);function y(e,t){let n=e;for(;n;){if(n.name===t||n.type&&n.type.name===t)return!0;n=n.type}return!1}function c(e){return y(e,"reference")}function s(e){let t=e;for(;t;){if(!t.type)return t;t=t.type}}function f(e){return"fields"in e?e.type?f(e.type).concat(e.fields):e.fields:[]}let d=function(e){let r,o,l=(0,t.c)(6),{schemaType:p,theme:y}=e,{theme:c,scheme:s,tone:f}=y;l[0]===Symbol.for("react.memo_cache_sentinel")?(r=new u.ServerStyleSheet,l[0]=r):r=l[0];let d=r,m=p.icon;return l[1]!==m||l[2]!==s||l[3]!==c||l[4]!==f?(o=m?(0,a.jsx)(u.StyleSheetManager,{sheet:d.instance,children:(0,a.jsx)(n.ThemeProvider,{theme:c,scheme:s,tone:f,children:(0,i.isValidElement)(m)?m:(0,a.jsx)(m,{})})}):null,l[1]=m,l[2]=s,l[3]=c,l[4]=f,l[5]=o):o=l[5],o};function m(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={_ref:{type:"objectField",name:"_ref",value:{type:"string"}},_type:{type:"objectField",name:"_type",value:{type:"string",value:"reference"}},_weak:{type:"objectField",name:"_weak",value:{type:"boolean"},optional:!0}};return t&&(n._key={type:"objectField",name:"_key",value:{type:"string"}}),{type:"object",fields:n,dereferencesTo:e}}let v=new Map([["text",{type:"string"}],["url",{type:"string"}],["datetime",{type:"string"}],["date",{type:"string"}],["boolean",{type:"boolean"}],["email",{type:"string"}]]);function g(){return{type:"objectField",name:"_key",value:{type:"string"}}}function h(e){let{path:t,type:n}=e;return[t,n]}function b(e,t){return'"'.concat(t,'": ').concat(e,"[0]._type")}var j=(0,i.memo)(function(e){let u,j,_,w,S,T=(0,t.c)(12),{comlink:A,perspective:E}=e,k=(0,r.useWorkspace)(),F=(0,n.useRootTheme)();T[0]!==A||T[1]!==F||T[2]!==k?(u=()=>{try{let e=function(e,t){let n=new Set,{schema:i,basePath:r}=e;return(function(e){let t=new Set,n=new Map;e.getTypeNames().forEach(i=>{let r=e.get(i);if(void 0===r||null===r.type)return;let o=new Set;(function e(n,i){if(!t.has(n)){if(t.add(n),"fields"in n)for(let t of f(n)){let r,o=s(t.type);if("document"===o.name){i.add(o);continue}n.type.type?r=t.type.type.name:"jsonType"in n.type&&(r=t.type.jsonType),("object"===r||"block"===r)&&(c(t.type)?t.type.to.forEach(e=>i.add(e.type)):i.add(t.type)),e(t.type,i)}else if("of"in n)for(let t of n.of)e(t,i)}})(r,o),n.set(r,o),t.clear()});let i=[],r=new Set,o=new Set;for(let[e]of n)!function e(t){if(o.has(t)||r.has(t))return;r.add(t);let l=n.get(t);void 0!==l&&l.forEach(t=>e(t)),r.delete(t),o.add(t),i.includes(t.name)||i.unshift(t.name)}(e);return i})(i).map(e=>{let t=i.get(e);if(void 0===t)return;let r=function(e){let t;if(e.type?t=e.type.name:"jsonType"in e&&(t=e.jsonType),"document"===t){let t=l(e);return"unknown"===t.type?null:{type:"document",name:e.name,title:"string"==typeof e.title?e.title:void 0,icon:o(e),fields:{...{_id:{type:"objectField",name:"_id",value:{type:"string"}},_type:{type:"objectField",name:"_type",value:{type:"string",value:e.name}},_createdAt:{type:"objectField",name:"_createdAt",value:{type:"string"}},_updatedAt:{type:"objectField",name:"_updatedAt",value:{type:"string"}},_rev:{type:"objectField",name:"_rev",value:{type:"string"}}},...t.fields}}}let n=u(e);return"unknown"===n.type?null:"object"===n.type?{name:e.name,type:"type",value:{type:"object",fields:{_type:{type:"objectField",name:"_type",value:{type:"string",value:e.name}},...n.fields}}}:{name:e.name,title:"string"==typeof e.title?e.title:void 0,type:"type",value:n}}(t);if(null!==r)return"type"===r.type&&n.add(t),r}).filter(e=>void 0!==e);function o(e){if(e.icon)return(0,p.renderToString)((0,a.jsx)(d,{schemaType:e,theme:t}))}function l(e){let t={};for(let n of f(e)){let e=u(n.type);null!==e&&(t[n.name]={type:"objectField",name:n.name,title:"string"==typeof n.type.title?n.type.title:void 0,value:e,optional:!1===function(e){let{validation:t}=e.type;if(!t)return!1;for(let e of Array.isArray(t)?t:[t]){let t=!1,n=new Proxy({},{get:(e,i)=>()=>("required"===i&&(t=!0),n)});if("function"==typeof e&&(e(n),t)||"object"==typeof e&&null!==e&&"_required"in e&&"required"===e._required)return!0}return!1}(n)})}return{type:"object",fields:t}}function u(e){if((null==(i=s(e))?void 0:i.name)==="document")return m(e.name);if(n.has(e.type)||(null==(p=e.type)||null==(a=p.type)?void 0:a.name)==="object")return{type:"inline",name:e.type.name};if(y(e,"string")){let t=null==(d=e.options)?void 0:d.list;return t&&Array.isArray(t)?{type:"union",of:t.map(e=>({type:"string",value:"string"==typeof e?e:e.value}))}:{type:"string"}}if(y(e,"number")){let t=null==(h=e.options)?void 0:h.list;return t&&Array.isArray(t)?{type:"union",of:t.map(e=>({type:"number",value:"number"==typeof e?e:e.value}))}:{type:"number"}}let t=v.get((null==(f=e.type)?void 0:f.name)||"");if(t)return t;if(e.type&&v.has(e.type.name))return v.get(e.type.name);if(y(e,"crossDatasetReference"))return{type:"unknown"};if(c(e)){let t=(b=e,[...new Set((function e(t){let n="to"in t?t.to:[];return"type"in t&&c(t.type)?[...e(t.type),...n]:n})(b).map(e=>e.name))]);return 1===t.length?m(t[0]):{type:"union",of:t.map(e=>({type:"unionOption",name:e,value:m(e)}))}}if(y(e,"array")){var i,a,p,f,d,h,b,j=e;let t=[];for(let e of j.of){let n=u(e),i={type:"unionOption",icon:o(e),name:e.name,title:"string"==typeof e.title?e.title:void 0,value:n};"inline"===n.type?n={type:"object",fields:{_key:g()},rest:n}:"object"===n.type&&(n.rest={type:"object",fields:{_key:g()}}),i.value=n,t.push(i)}if(0===t.length)return{type:"null"};if(t.length>1)return{type:"union",of:t,options:function(e,t){var n;let{options:i}=e;if(!i)return;let o={...i};return i.insertMenu&&(o.insertMenu={...i.insertMenu,views:null==(n=i.insertMenu.views)?void 0:n.map(e=>"grid"===e.name?{name:"grid",previewImageUrls:e.previewImageUrl?t.reduce((t,n)=>{var i;let{name:o}=n,l=null==(i=e.previewImageUrl)?void 0:i.call(e,o);if(!l)return t;try{new URL(l),t[o]=l}catch(e){t[o]=new URL(l,"".concat(window.location.origin).concat(r?"".concat(r,"/"):"")).toString()}return t},{}):void 0}:e)}),o}(j,t)};let{name:n,title:l,value:y}=t[0];return{type:"array",of:{type:"arrayItem",name:n,title:"string"==typeof l?l:void 0,value:y}}}if(y(e,"object")||"object"===e.jsonType||"fields"in e)return l(e);throw Error('Type "'.concat(e.name,'" not found'))}}(k,F);return A.post("presentation/schema",{schema:e}),A.on("visual-editing/schema",()=>({schema:e}))}catch(e){return}},j=[A,F,k],T[0]=A,T[1]=F,T[2]=k,T[3]=u,T[4]=j):(u=T[3],j=T[4]),(0,i.useEffect)(u,j),T[5]!==E?(_=(0,r.isReleasePerspective)(E)?r.RELEASES_STUDIO_CLIENT_OPTIONS:{apiVersion:l.API_VERSION},T[5]=E,T[6]=_):_=T[6];let I=(0,r.useClient)(_);return T[7]!==I||T[8]!==A||T[9]!==E?(w=()=>A.on("visual-editing/schema-union-types",async e=>{let t=Object.entries(e.paths.reduce((e,t)=>{let{id:n,path:i}=t;return e[n]?e[n].add(i):e[n]=new Set([i]),e},{})),n=await Promise.all(t.map(async e=>{let[t,n]=e,i=Array.from(n),r="*[_id == $id][0]{".concat(i.map(b).join(","),"}"),l=await I.fetch(r,{id:(0,o.getPublishedId)(t)},{tag:"presentation-schema",perspective:E});return{id:t,paths:i.map((e,t)=>({path:e,type:l[t]}))}})),i=new Map;return n.forEach(e=>{i.set(e.id,new Map(e.paths.map(h)))}),{types:i}}),S=[A,I,E],T[7]=I,T[8]=A,T[9]=E,T[10]=w,T[11]=S):(w=T[10],S=T[11]),(0,i.useEffect)(w,S),null})}]);